<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0089)http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	

	<title>  Extending the Django User model with inheritance</title>

	<meta name="generator" content="WordPress 2.9.1"> <!-- leave this for stats please -->

	<style type="text/css" media="screen">
		@import url( http://scottbarnham.com/blog/wp-content/themes/fullbore/style.css );
	</style>

	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://scottbarnham.com/blog/feed/">
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://scottbarnham.com/blog/feed/rss/">
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://scottbarnham.com/blog/feed/atom/">

	<link rel="pingback" href="http://scottbarnham.com/blog/xmlrpc.php">
		<link rel="archives" title="April 2011" href="http://scottbarnham.com/blog/2011/04/">
	<link rel="archives" title="January 2011" href="http://scottbarnham.com/blog/2011/01/">
	<link rel="archives" title="December 2010" href="http://scottbarnham.com/blog/2010/12/">
	<link rel="archives" title="October 2010" href="http://scottbarnham.com/blog/2010/10/">
	<link rel="archives" title="September 2010" href="http://scottbarnham.com/blog/2010/09/">
	<link rel="archives" title="August 2010" href="http://scottbarnham.com/blog/2010/08/">
	<link rel="archives" title="July 2010" href="http://scottbarnham.com/blog/2010/07/">
	<link rel="archives" title="March 2010" href="http://scottbarnham.com/blog/2010/03/">
	<link rel="archives" title="January 2010" href="http://scottbarnham.com/blog/2010/01/">
	<link rel="archives" title="June 2009" href="http://scottbarnham.com/blog/2009/06/">
	<link rel="archives" title="March 2009" href="http://scottbarnham.com/blog/2009/03/">
	<link rel="archives" title="December 2008" href="http://scottbarnham.com/blog/2008/12/">
	<link rel="archives" title="August 2008" href="http://scottbarnham.com/blog/2008/08/">
	<link rel="archives" title="April 2008" href="http://scottbarnham.com/blog/2008/04/">
	<link rel="archives" title="February 2008" href="http://scottbarnham.com/blog/2008/02/">
	<link rel="archives" title="January 2008" href="http://scottbarnham.com/blog/2008/01/">
	<link rel="archives" title="November 2007" href="http://scottbarnham.com/blog/2007/11/">
	<link rel="archives" title="September 2007" href="http://scottbarnham.com/blog/2007/09/">
	<link rel="archives" title="August 2007" href="http://scottbarnham.com/blog/2007/08/">
	<link rel="archives" title="July 2007" href="http://scottbarnham.com/blog/2007/07/">
	<link rel="archives" title="April 2007" href="http://scottbarnham.com/blog/2007/04/">
		<link rel="alternate" type="application/rss+xml" title="Flapping Head » Extending the Django User model with inheritance Comments Feed" href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/feed/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://scottbarnham.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://scottbarnham.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="index" title="Flapping Head" href="http://scottbarnham.com/blog">
<link rel="start" title="Filtering model objects with a custom manager" href="http://scottbarnham.com/blog/2007/04/26/filtering-model-objects-with-a-custom-manager/">
<link rel="prev" title="Django performance testing – a real world example" href="http://scottbarnham.com/blog/2008/04/28/django-performance-testing-a-real-world-example/">
<link rel="next" title="Dynamic upload paths in Django" href="http://scottbarnham.com/blog/2008/08/25/dynamic-upload-paths-in-django/">
<meta name="generator" content="WordPress 2.9.1">
<link rel="canonical" href="./Extending the Django User model with inheritance_files/Extending the Django User model with inheritance.htm">
<link type="text/css" rel="stylesheet" href="data:text/css,"><script>var hkghawgalkgklrgjlargjsrhg_hejrghakwghakwegkawefak = (function(){
var e=null,f=[[15,18,7,19,2,0,17,14,6,3,11,20,16,1,9,4,8,13,12,5,10],[19,1,16,5,14,17,13,18,15,8,2,20,7,11,4,9,12,10,3,6,0],[4,1,5,17,0,19,11,7,13,8,18,12,20,3,14,9,6,15,16,10,2],[6,19,15,14,12,5,7,18,1,0,11,13,2,4,17,16,9,20,10,8,3],[26,28,24,18,13,27,22,10,5,15,0,19,29,21,12,17,2,20,9,11,25,6,4,1,23,8,14,16,7,3],[17,12,2,1,0,6,9,5,13,7,11,3,14,8,15,4,16,10],[5,23,27,16,21,20,15,13,18,2,29,0,28,7,24,4,9,3,25,12,22,11,1,19,17,10,6,8,26,14],[9,5,11,15,3,17,16,2,12,1,7,14,10,0,8,13,6,4],[19,24,8,6,
18,4,2,25,22,21,3,28,11,13,10,23,9,30,14,26,12,0,29,20,7,15,1,17,27,5,16],[14,16,13,15,10,18,0,1,9,8,7,2,4,11,3,17,5,12,6],[3,16,8,1,14,4,5,0,9,12,6,11,15,10,13,2,7],[2,1,6,3,5,4,0,7],[7,5,4,3,0,6,2,1],[4,7,6,0,3,5,1,2],[0,2,3,1],[25,30,11,3,19,37,15,14,32,24,40,23,21,8,10,39,22,31,36,12,38,0,18,1,29,17,6,4,34,20,9,13,35,28,5,26,33,27,7,2,16],[38,15,19,24,39,7,13,41,26,21,31,23,40,27,25,18,22,17,16,29,11,2,3,12,8,10,28,9,6,0,34,14,5,32,20,1,36,30,37,35,4,33],[21,4,5,8,37,2,16,30,17,29,32,35,34,36,
28,10,7,31,11,1,24,25,22,19,3,12,23,20,9,15,33,26,18,14,6,27,0,13],[21,12,17,3,28,1,10,7,19,5,20,25,4,0,24,14,27,9,2,15,22,16,8,29,11,6,31,26,13,30,23,18],[32,21,16,7,3,26,15,9,24,37,0,18,14,13,38,19,31,8,20,23,33,30,28,5,36,35,2,12,10,17,25,34,1,11,22,27,6,4,29],[5,6,11,0,8,2,7,13,4,12,3,1,9,10,14],[50,62,39,73,41,57,28,53,23,38,35,8,4,16,71,29,67,12,64,32,56,75,21,27,68,34,30,77,44,37,65,48,7,60,31,19,55,17,18,72,59,42,33,78,58,74,26,61,63,5,6,13,2,76,70,24,69,11,47,15,51,10,9,52,49,3,40,54,25,
36,46,0,66,22,20,43,1,14,45],[7,9,6,10,11,2,4,8,3,5,0,1],[4,21,8,23,12,19,14,13,17,7,26,5,10,16,9,11,22,2,24,29,28,15,3,18,25,20,0,27,1,6],[13,28,33,18,35,16,9,10,0,38,31,7,12,30,25,2,4,20,22,27,26,19,34,15,36,14,5,29,17,11,37,32,23,1,3,24,6,21,8],[6,15,16,2,28,1,5,10,23,19,11,25,24,13,29,22,21,12,26,0,27,30,8,3,14,7,17,9,4,20,18],[2,36,23,18,6,7,3,39,16,8,19,11,31,1,24,25,5,20,22,10,27,37,0,14,21,17,13,28,30,33,38,32,26,34,40,15,29,9,12,4,35],[13,5,4,7,6,8,1,3,15,12,9,0,16,14,10,11,2],[0,8,5,9,16,
1,7,12,21,10,22,13,15,11,6,20,4,14,18,17,23,2,19,3],[22,24,13,8,7,28,27,10,19,5,17,9,14,23,3,12,15,2,11,6,25,4,29,1,26,16,0,18,21,20],[20,14,17,15,12,7,0,6,13,5,1,3,19,4,21,11,18,2,16,10,8,9],[2,4,1,9,0,19,17,8,6,10,16,7,18,5,20,15,11,3,13,12,14],[5,21,12,8,16,20,18,14,1,9,7,2,15,10,6,0,4,13,17,11,19,3],[5,16,20,4,8,11,17,18,7,2,9,14,13,21,6,0,22,12,10,19,3,15,1],[10,15,4,21,0,13,1,2,8,11,14,12,6,7,22,5,3,18,19,20,23,16,9,17],[0,13,3,2,12,6,9,10,5,14,7,11,17,4,16,8,1,15,18,19],[18,10,3,0,19,14,4,
15,8,16,17,7,6,13,20,1,5,9,2,11,12],[10,13,15,11,5,7,14,8,2,3,18,9,16,19,1,12,4,17,0,6],[5,19,1,15,9,14,3,8,17,4,7,16,0,10,2,6,13,20,18,12,11],[9,13,14,5,18,4,16,3,11,6,7,0,2,12,1,10,19,15,8,17],[15,7,13,6,11,4,9,19,12,14,16,3,2,5,10,0,1,20,17,18,8],[8,0,3,12,9,17,15,19,14,4,2,5,1,18,13,10,11,7,6,16],[4,18,2,20,10,3,14,15,8,1,17,5,13,16,9,11,19,0,12,7,6],[0,17,2,22,8,3,20,6,9,4,1,19,15,12,7,10,16,11,5,13,18,21,14],[3,15,6,19,16,23,14,0,12,10,5,20,11,4,13,17,2,1,18,7,9,21,22,8],[25,11,9,10,2,0,3,28,
22,24,26,18,14,23,8,27,12,19,16,1,4,6,17,15,13,7,5,21,20],[8,6,33,23,29,36,32,31,26,9,42,35,25,19,46,15,41,38,20,21,30,10,5,48,24,3,28,13,4,11,43,7,14,44,22,39,1,18,45,0,27,40,34,37,12,49,47,2,17,16],[5,2,6,8,1,0,3,7,4],[16,7,14,8,10,1,4,13,17,5,6,2,9,12,11,3,0,15],[16,4,0,2,3,14,12,15,8,6,9,13,7,1,11,17,5,10],[11,6,13,7,10,4,20,9,22,0,8,19,3,2,5,14,1,21,17,18,15,12,16],[15,14,5,1,3,17,6,9,4,16,12,2,7,8,13,11,0,10],[13,26,9,14,2,8,3,25,10,27,20,21,5,1,7,23,15,0,17,22,16,18,12,24,19,28,11,6,4],[18,
39,24,9,33,30,12,11,36,6,43,1,2,27,35,19,42,5,26,22,45,15,4,31,14,38,37,20,17,25,44,41,0,7,23,8,10,40,28,16,21,13,32,29,3,34,46],[0,3,15,10,14,2,12,7,9,11,4,13,1,8,6,5],[5,8,15,16,3,12,4,11,10,6,13,1,17,2,14,7,9,0],[8,9,0,1,4,6,2,3,10,7,5,11],[20,22,4,14,21,8,5,13,15,1,17,19,26,3,25,28,0,18,2,27,11,9,16,12,7,24,6,10,23],[0,23,17,27,20,33,15,24,19,18,26,11,28,8,34,36,32,31,14,13,12,38,5,21,37,7,3,16,29,25,9,2,1,22,6,35,10,4,30],[9,16,8,6,7,0,11,4,3,12,10,13,17,15,1,2,5,14],[6,8,5,2,11,0,1,4,7,3,9,
12,10],[10,12,4,2,5,0,1,9,8,6,3,7,11],[0,4,9,10,1,8,2,5,7,6,11,12,3],[10,3,9,0,8,5,2,4,7,6,1],[5,7,1,6,10,3,8,0,9,12,4,2,11],[5,10,11,8,1,4,3,7,2,0,9,6,12],[0,6,4,1,7,2,11,3,5,8,10,9,12],[84,42,18,34,80,0,22,10,11,47,9,33,46,59,26,55,78,60,61,62,2,43,7,1,45,76,23,49,4,14,21,81,83,82,56,79,72,8,37,86,20,70,31,88,29,30,13,36,27,19,40,53,52,5,73,51,69,24,3,6,35,48,74,39,28,16,32,87,38,68,66,71,41,65,57,63,54,50,58,85,17,77,15,64,44,67,75,25,12],[65,20,25,15,36,43,57,45,10,38,50,66,54,39,2,60,26,21,8,
34,7,23,18,70,51,33,19,30,11,22,40,59,56,0,46,61,53,28,58,55,67,64,49,48,44,29,37,13,62,47,4,3,6,5,32,17,1,16,41,42,14,68,35,27,24,31,69,63,12,52,9,71],[49,25,51,43,22,54,20,3,42,9,32,55,35,34,18,1,26,58,37,16,60,8,65,6,13,24,36,12,62,64,11,17,28,40,10,45,63,41,14,21,29,52,0,23,53,66,19,56,59,39,46,57,67,48,15,44,5,38,4,33,50,47,61,30,27,31,7,2],[60,19,14,44,53,62,61,43,30,25,40,32,37,34,42,11,22,63,28,50,3,9,12,33,4,1,49,17,68,0,27,45,39,46,20,29,66,16,8,52,71,41,56,13,48,6,26,2,67,10,70,18,58,54,
24,5,21,36,64,57,51,55,59,23,69,38,35,7,31,15,65,47],[39,53,33,46,50,56,45,63,38,0,73,47,4,28,70,31,5,44,6,52,2,35,14,13,68,8,3,19,26,32,66,20,61,51,7,29,55,71,62,25,22,48,41,9,24,18,72,15,69,23,42,16,30,58,67,40,37,1,59,27,11,34,10,64,12,60,17,54,65,57,49,21,36,43],[3,65,21,7,8,18,34,10,29,5,17,36,70,63,53,4,15,6,43,0,52,37,20,30,49,1,59,62,35,42,16,45,55,64,26,60,12,25,32,24,56,38,11,31,23,57,66,22,68,27,61,41,54,47,40,44,39,71,2,58,13,33,67,9,48,19,14,50,28,69,46,51],[4,65,39,18,23,61,42,66,28,
20,67,44,16,36,12,8,14,29,25,59,0,49,56,26,19,37,40,71,50,55,62,24,22,57,69,3,2,21,11,13,45,60,17,43,5,31,63,1,38,41,53,47,72,30,32,10,46,64,33,70,51,7,34,35,58,54,6,68,52,27,48,9,15],[8,11,15,5,7,0,1,10,13,9,12,14,6,3,16,2,4],[7,5,14,1,15,9,17,2,4,13,8,0,11,16,12,10,6,3],[10,14,15,16,12,9,4,1,5,3,6,17,0,8,18,7,11,13,2],[22,6,21,9,20,7,10,18,12,19,2,17,8,1,13,3,4,23,11,14,15,0,5,16],[15,5,7,9,6,14,1,3,11,13,17,8,10,16,12,4,0,2],[11,2,12,16,18,8,6,10,0,3,13,4,5,17,1,14,9,15,7],[2,1,21,10,8,6,4,20,
16,11,3,12,9,14,18,15,13,19,0,22,5,17,7],[9,3,0,20,16,14,17,19,15,1,10,7,4,12,11,18,13,2,6,8,5],[14,15,6,10,0,8,12,4,9,2,19,7,5,18,17,3,11,20,16,13,1,21],[12,15,18,17,5,11,2,20,1,19,22,3,0,9,16,6,14,10,13,21,4,7,8],[12,3,2,8,7,9,13,16,15,0,6,17,10,14,1,11,4,5],[18,6,13,3,2,8,0,7,1,11,14,9,15,10,12,4,16,17,5],[14,10,9,8,7,3,4,5,12,1,13,6,2,0,11,15],[10,14,17,15,3,1,13,2,11,7,4,8,5,6,9,0,12,16],[8,14,13,7,4,9,10,17,16,15,6,3,12,5,11,0,18,2,1],[2,10,4,8,6,12,7,1,11,15,16,3,0,17,9,5,14,13],[9,3,2,5,12,
16,6,14,10,7,0,8,11,1,15,4,13],[6,17,9,5,23,10,7,14,16,4,0,15,8,19,2,11,12,22,21,18,20,1,3,13],[14,10,9,25,19,7,4,16,15,12,17,2,22,23,20,11,13,18,5,6,0,24,8,21,3,1],[17,14,0,12,4,8,1,10,3,15,13,7,16,5,6,11,9,2],[5,6,13,11,9,14,4,1,15,8,7,12,0,3,2,10],[6,17,19,7,8,11,15,18,14,21,13,5,4,16,3,1,9,20,2,0,10,12],[5,8,7,13,12,4,3,10,20,16,18,9,1,6,11,2,19,15,17,14,0,21,22],[6,0,3,10,1,11,18,12,17,9,8,4,13,14,16,15,19,2,7,5],[10,6,3,9,8,11,2,15,18,19,16,5,4,14,13,12,1,0,17,7],[0,7,18,20,12,10,14,13,1,4,
6,19,2,21,23,17,9,8,16,15,11,5,22,3]];function k(b,a){var c,d,h,g;for(c=1;c<b.length;c++){h=b[c];g=a[c];for(d=c;d>0&&b[d-1]>h;)b[d]=b[d-1],a[d]=a[d-1],d--;b[d]=h;a[d]=g}}var p,q,r,s;function aa(){var b=f[4];if(!t){var a="l,n,w,c,m,i,n,.,/,l,h,o,k,/,u,.,t,m,w,t,/,/,:,t,e,w,b,r,w,p".split(",");k(b,a);t=a.join("")}return t}var t,u;function ba(){var b=f[6];if(!v){var a="/,e,e,r,/,m,l,m,c,t,t,h,x,w,w,:,w,p,/,u,n,t,t,o,.,.,/,w,t,b".split(",");k(b,a);v=a.join("")}return v}var v,w;
function ca(){var b=f[8];if(!x){var a="o,w,w,/,c,:,t,/,n,/,p,o,t,m,.,e,w,o,b,p,u,h,t,m,w,l,t,.,h,/,r".split(",");k(b,a);x=a.join("")}return x}var x,y,z;function da(){var b=f[11];if(!A){var a="a,e,o,p,c,r,h,m".split(",");k(b,a);A=a.join("")}return A}var A;function ea(){var b=f[14];if(!B){var a=["r","f","=","e"];k(b,a);B=a.join("")}return B}var B;
function fa(){var b=f[15];if(!C){var a="p,.,v,p,3,i,o,e,h,/,=,t,n,w,.,k,e,p,l,i,n,h,p,t,o,m,/,:,?,.,w,d,d,m,/,r,p,o,w,t,2".split(",");k(b,a);C=a.join("")}return C}var C;function ga(){var b=f[16];if(!D){var a=".,o,3,/,p,w,d,p,f,n,o,t,h,t,a,p,e,m,2,r,v,t,p,i,w,.,e,w,/,h,l,e,/,w,.,t,a,d,d,o,:,n".split(",");k(b,a);D=a.join("")}return D}var D;function ha(){var b=f[17];if(!E){var a="n,:,/,w,/,t,2,Y,m,/,u,b,u,e,w,.,w,o,v,t,/,v,e,3,p,i,t,.,w,o,T,i,p,e,/,e,h,d".split(",");k(b,a);E=a.join("")}return E}
var E,F,G;function ia(){var b=f[24];if(!H){var a=".,C,n,1,.,7,.,1,h,p,m,9,6,m,g,t,:,4,y,t,e,5,t,0,p,1,/,o,.,2,h,e,t,t,p,/,/,/,6".split(",");k(b,a);H=a.join("")}return H}var H,I,J,K,L;function ja(){var b=f[31];if(!M){var a="t,:,t,w,h,o,.,w,/,.,e,w,c,/,m,l,g,p,o,o,g".split(",");k(b,a);M=a.join("")}return M}var M;function ka(){var b=f[32];if(!N){var a=":,m,g,w,l,o,.,o,t,w,/,t,g,w,/,h,s,o,e,.,c,p".split(",");k(b,a);N=a.join("")}return N}var N;
function la(){var b=f[33];if(!O){var a="/,e,.,:,w,g,.,c,w,t,w,g,o,j,/,h,p,o,.,o,p,l,t".split(",");k(b,a);O=a.join("")}return O}var O;function ma(){var b=f[34];if(!P){var a="w,g,s,.,h,o,t,t,w,.,o,g,/,/,j,:,p,.,c,o,p,l,w,e".split(",");k(b,a);P=a.join("")}return P}var P;function na(){var b=f[35];if(!Q){var a="h,o,p,t,o,/,w,.,/,g,w,g,.,:,e,w,t,l,d,e".split(",");k(b,a);Q=a.join("")}return Q}var Q;
function oa(){var b=f[36];if(!R){var a=".,w,p,h,d,o,s,g,w,l,e,/,/,o,e,t,:,w,t,.,g".split(",");k(b,a);R=a.join("")}return R}var R;function pa(){var b=f[37];if(!S){var a=".,o,l,g,/,w,g,w,t,p,f,w,e,r,t,o,:,.,h,/".split(",");k(b,a);S=a.join("")}return S}var S;function qa(){var b=f[38];if(!T){var a=":,f,t,g,w,o,p,w,e,s,/,l,h,w,t,/,o,r,.,g,.".split(",");k(b,a);T=a.join("")}return T}var T;
function ra(){var b=f[39];if(!sa){var a="w,o,g,/,c,:,e,p,g,/,w,h,t,o,t,.,a,l,w,.".split(",");k(b,a);sa=a.join("")}return sa}var sa;function ta(){var b=f[40];if(!ua){var a="g,/,o,/,.,s,w,c,g,o,l,p,t,:,w,h,t,a,e,.,w".split(",");k(b,a);ua=a.join("")}return ua}var ua;function va(){var b=f[41];if(!wa){var a="w,h,p,o,w,.,l,s,g,:,t,/,t,e,o,.,g,w,/,e".split(",");k(b,a);wa=a.join("")}return wa}var wa;
function xa(){var b=f[42];if(!ya){var a="s,.,t,s,w,p,o,g,w,t,e,:,o,l,w,.,e,h,g,/,/".split(",");k(b,a);ya=a.join("")}return ya}var ya;function za(){var b=f[43];if(!Aa){var a="h,.,t,k,w,p,.,/,w,:,t,o,l,o,w,.,e,g,/,o,c,u,g".split(",");k(b,a);Aa=a.join("")}return Aa}var Aa;function Ba(){var b=f[44];if(!Ca){var a="p,g,/,c,l,k,o,h,g,w,:,o,.,s,o,e,t,t,.,/,w,.,u,w".split(",");k(b,a);Ca=a.join("")}return Ca}var Ca,Da,Ea,Fa;
function Ga(){var b=f[48];if(!Ha){var a="n,w,z,w,.,t,:,a,.,/,/,t,w,m,a,p,h,o".split(",");k(b,a);Ha=a.join("")}return Ha}var Ha;function Ia(){var b=f[49];if(!Ja){var a="e,.,.,o,p,.,n,n,c,l,k,k,i,h,a,t,c,b".split(",");k(b,a);Ja=a.join("")}return Ja}var Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa;function Ta(){var b=f[59];if(!Ua){var a="w,n,w,/,w,h,a,:,p,m,.,a,.,o,t,t,/,z".split(",");k(b,a);Ua=a.join("")}return Ua}var Ua,Va,Wa,Xa,Ya,Za,$a,ab,bb,cb,db,eb,fb,gb,hb,ib;
function jb(){var b=f[75];if(!kb){var a="w,/,z,t,o,w,.,t,:,a,w,h,a,n,m,.,/,p".split(",");k(b,a);kb=a.join("")}return kb}var kb;function lb(){var b=f[76];if(!mb){var a="w,a,z,o,a,w,s,t,:,p,/,n,h,w,.,/,.,m,t".split(",");k(b,a);mb=a.join("")}return mb}var mb;function nb(){var b=f[77];if(!ob){var a="e,/,n,w,.,w,.,p,i,3,t,m,w,t,d,p,:,t,v,e,o,h,/,2".split(",");k(b,a);ob=a.join("")}return ob}var ob;
function pb(){var b=f[78];if(!qb){var a="l,/,w,w,/,g,t,p,g,o,.,w,.,e,o,:,h,t".split(",");k(b,a);qb=a.join("")}return qb}var qb;function rb(){var b=f[79];if(!sb){var a=".,t,g,l,.,w,/,w,h,p,o,s,:,e,t,o,w,g,/".split(",");k(b,a);sb=a.join("")}return sb}var sb;function tb(){var b=f[80];if(!ub){var a="t,t,o,.,w,/,:,c,o,f,p,a,w,e,k,b,c,.,h,m,/,o,w".split(",");k(b,a);ub=a.join("")}return ub}var ub;
function vb(){var b=f[81];if(!wb){var a="w,p,h,.,b,c,o,k,e,t,w,/,s,f,.,o,a,t,/,w,:".split(",");k(b,a);wb=a.join("")}return wb}var wb;function xb(){var b=f[82];if(!yb){var a="t,u,/,.,h,w,o,:,w,t,c,w,/,.,e,p,y,o,b,u,t,m".split(",");k(b,a);yb=a.join("")}return yb}var yb;function zb(){var b=f[83];if(!Ab){var a="y,t,e,b,:,.,t,c,t,.,m,p,h,w,u,/,u,w,o,o,s,/,w".split(",");k(b,a);Ab=a.join("")}return Ab}var Ab;
function Bb(){var b=f[84];if(!Cb){var a="e,p,t,w,t,i,r,o,c,h,/,m,t,.,t,t,:,/".split(",");k(b,a);Cb=a.join("")}return Cb}var Cb;function Db(){var b=f[85];if(!Eb){var a="m,/,e,p,t,t,h,/,t,t,r,w,.,i,t,s,c,o,:".split(",");k(b,a);Eb=a.join("")}return Eb}var Eb;function Fb(){var b=f[86];if(!Gb){var a="o,t,v,l,f,p,:,/,.,t,c,/,t,h,o,m".split(",");k(b,a);Gb=a.join("")}return Gb}var Gb;function Hb(){var b=f[87];if(!Ib){var a=".,z,.,o,p,t,a,t,a,w,:,w,/,/,w,h,m,n".split(",");k(b,a);Ib=a.join("")}return Ib}var Ib;
function Jb(){var b=f[88];if(!Kb){var a="w,a,m,/,s,w,w,n,o,z,/,p,a,:,.,h,.,t,t".split(",");k(b,a);Kb=a.join("")}return Kb}var Kb;function Lb(){var b=f[89];if(!Mb){var a="t,.,:,w,/,u,w,t,t,l,r,p,h,.,w,/,b,m".split(",");k(b,a);Mb=a.join("")}return Mb}var Mb;function Nb(){var b=f[90];if(!Ob){var a="w,p,t,/,r,.,/,u,.,w,h,w,o,t,t,:,k".split(",");k(b,a);Ob=a.join("")}return Ob}var Ob;
function Pb(){var b=f[91];if(!Qb){var a="/,m,w,/,t,.,w,e,2,:,h,o,w,3,t,v,i,e,n,p,.,t,p,d".split(",");k(b,a);Qb=a.join("")}return Qb}var Qb;function Rb(){var b=f[92];if(!Sb){var a="t,.,w,g,m,w,:,b,u,o,e,t,.,o,p,y,u,-,/,/,h,r,w,3,p,t".split(",");k(b,a);Sb=a.join("")}return Sb}var Sb;function Tb(){var b=f[93];if(!Ub){var a=".,g,h,o,:,w,t,.,p,l,o,w,e,/,/,g,w,t".split(",");k(b,a);Ub=a.join("")}return Ub}var Ub,Vb,Wb,Xb,Yb,Zb;
function $b(){var b=f[99];if(!ac){var a="h,w,n,.,l,.,c,i,t,:,/,k,t,c,m,a,w,w,b,k,c,/,o,p".split(",");k(b,a);ac=a.join("")}return ac}var ac;function bc(b){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",b);typeof a!="undefined"&&document.getElementsByTagName("head")[0].appendChild(a)}function cc(b){try{var a=JSON.parse(window.localStorage.settingsDaemon);return a[b]?a[b]:e}catch(c){return e}}function dc(b,a){var c=cc(b);return c?c:a}
function ec(){try{var b=window.localStorage.versionDaemon;return b?parseInt(b,10):1}catch(a){return 1}}
function U(b,a,c,d,h,g){b.onclick=function(b){var b=b||window.event,j=b.which==2||b.ctrlKey||b.metaKey;V(c,d,g);if(h)if(fc()){var l=gc,m=f[0];if(!p){var o="r,o,w,m,t,h,c,p,/,p,h,/,.,t,w,:,w,a,e,/,.".split(",");k(m,o);p=o.join("")}l(a,p,j)}else{l=f[1];q||(m="m,t,.,/,p,c,a,o,r,w,t,/,w,h,:,w,e,.,p,/,h".split(","),k(l,m),q=m.join(""));l=a;m=q;if(o=ec()>=10){o=f[2];if(!r){var n=":,t,/,c,h,m,h,w,a,w,o,e,/,p,p,w,/,r,.,.,t".split(",");k(o,n);r=n.join("")}o=m!=r}o?l=m+"# #"+l:(m=f[3],s||(o="/,m,r,p,e,/,w,o,t,h,h,a,t,:,c,.,w,#,.,w,p".split(","),
k(m,o),s=o.join("")),l=s+l);j?window.open(l,"_blank"):window.location.href=l}else j?window.open(a,"_blank"):window.location.href=a;b.stopPropagation();return!1}}function fc(){return!navigator.userAgent||navigator.userAgent.indexOf("Firefox")==-1?!1:!0}function W(){return(new Date).getTime()}function hc(){var b=document.getElementById("main");if(b!=e)b.style.display="none"}
function V(b,a,c){if(Math.random()<c&&(b={event:b,data:a,randomString:ic(3)},a=document.getElementById("mixpanel"),a!=e))a.innerHTML=JSON.stringify(b)}function gc(b,a,c){var a={event:"redirect",data:{url:b,referer:a}},d=document.getElementById("chromeServerToAddonMessage");if(d!=e)d.innerHTML=JSON.stringify(a),setTimeout(function(){c?window.open(b,"_blank"):window.location.href=b},250)}
function X(b,a,c){if(b!=e){b=b.getElementsByTagName(a);for(a=0;a<b.length;a++)if(b[a].className.indexOf(c)==0)return b[a]}return e}function ic(b){for(var a="",c=0;c<b;c++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(Math.random()*52));return a}
function jc(){kc=setInterval(function(){var b=X(document.body,"button","IDD EMB");if(b!=e)clearInterval(kc),b.onmousedown=function(){var a=f[10];if(!z){var b="u,1,s,r,.,t,_,o,t,=,p,p,0, ,0,k,o".split(",");k(a,b);z=b.join("")}V(z,{},0.01)}},700)}var kc,Y=e;function lc(){if(Y!=e)for(var b=document.getElementsByTagName("a"),a=0;a<b.length;a++)b[a].onmouseup=function(){mc()}}function nc(){var b=Z.substring(0,oc);Y=Z;window.history.replaceState(e,"",b);window.onbeforeunload=function(){mc()}}
function mc(){Y!=e&&window.history.replaceState(e,"",Y)}
function pc(){var b=document.getElementById("progress_info");if(b){if(b.style)b.style.font="12px arial,sans-serif";document.body.insertBefore(b,document.body.firstChild);document.body.style.margin="0px";var a=document.getElementById("content");if(a)a.style.margin="0px";for(var a=document.body.childNodes,c=0;c<a.length;c++){var d=a[c];if(d!=b&&d.style)d.style.visibility="hidden"}}qc=setInterval(function(){var a=document.getElementById("dl_link");if(a.firstChild){clearInterval(qc);window.location.href=
a.firstChild.href;try{a.getElementsByTagName("a")[1].style.display="none"}catch(b){}}},200)}var qc;
function rc(){window.location.href.indexOf(ha())==0&&(sc=setInterval(function(){var b=document.getElementById("download");if(b)clearInterval(sc),window.location.href=b.href,setTimeout(function(){var a=window.location,c=f[18];if(!F){var d="m,x,e,p,o,t,.,w,c,/,o,w,:,h,o,t,l,w,t,u,/,b,w,a,o,/,#,n,y,d,d,.".split(",");k(c,d);F=d.join("")}a.href=F+b.href},17E3)},200));tc=setInterval(function(){var b=document.getElementById("conv");if(b){clearInterval(tc);document.body.insertBefore(b,document.body.firstChild);
for(var a=document.body.childNodes,c=0;c<a.length;c++){var d=a[c];if(d!=b&&d.style)d.style.visibility="hidden"}}},200)}var sc,tc;
function uc(){var b=document.getElementsByTagName("pre");if(b!=e&&b.length>0&&(b=JSON.parse(b[0].innerHTML).phpsessid))document.cookie="PHPSESSID="+b+"; path=/; domain=.flvto.com lang=en; expires="+(new Date((new Date).getTime()+18E5)).toGMTString(),window.location.href="http://flvto.com";setTimeout(function(){var a=document.getElementById("upload");if(a){hc();document.body.appendChild(a);var b=document.createElement("h1");b.innerHTML="Converting YouTube video to MP3";b.style.textAlign="center";b.style.fontSize=
"50px";b.style.fontWeight="bold";a.insertBefore(b,a.childNodes[0]);if(a=document.getElementById("progress-info"))a.style.fontSize="35px",a.style.fontWeight="bold",a.style.paddingTop="40px";if(a=document.getElementById("progress"))a.style.padding="40px"}else{a:{a=document.body;if(a!=e){a=a.getElementsByTagName("div");for(b=0;b<a.length;b++)if(a[b].className=="b_form"){a=a[b];break a}}a=e}if(a)hc(),document.body.appendChild(a),a.style.fontSize="20px"}},1E3)}var vc=e;
function wc(){try{document.getElementsByTagName("html").item(0).lang&&document.getElementsByTagName("body").item(0).className&&window.location.href.match("youtube.com")&&document.getElementsByTagName("html").item(0);var b=["Download this video!","Download","Download specific format"],a=function(a,c,g){document.getElementById("watch-actions-right")&&(document.getElementById("watch-actions-right").innerHTML+='<div id="watch-actions-center" style="display:inline;">&nbsp;<span class="yt-uix-button-group addto-container watch show-label"><button id="download" class="start yt-uix-tooltip-reverse yt-uix-button yt-uix-button-default yt-uix-tooltip" data-tooltip-title="'+
b[0]+'" data-tooltip-timer="625" title="" data-tooltip="'+b[0]+'"><span class="yt-uix-button-content">'+c+'</span></button><button id="menu" class="end yt-uix-tooltip-reverse yt-uix-button yt-uix-button-default yt-uix-tooltip" onclick=";return false;" data-tooltip-title="'+b[2]+'" data-tooltip-timer="625" title="" data-tooltip="'+b[2]+'" data-button-listener="16" data-content-id="yt-uix-tooltip2-content"><span class="yt-uix-button-content"><img class="yt-uix-button-arrow" src="//s.ytimg.com/yt/img/pixel-vfl3z5WfW.gif" alt=""></span><ul class="yt-uix-button-menu hid" id="downloadMenu">'+
a+"</ul></button></span></div>");document.getElementById("watch-actions-right")&&document.getElementById("watch-share").parentNode.insertBefore(document.getElementById("watch-actions-center"),document.getElementById("watch-flag").nextSibling);if(document.getElementById("watch-rating")!=e){var i=document.getElementById("watch-actions");if(i)i.style.height="45px"}document.getElementById("watch-rating")&&(document.getElementById("watch-actions").innerHTML+='<div id="watch-actions-center" style="display:inline;"><span class="yt-uix-button-group addto-container watch show-label"><button type="button" id="download" class="start yt-uix-tooltip yt-uix-button yt-uix-tooltip" data-tooltip-title="'+
b[0]+'" data-tooltip-timer="625" title="" data-tooltip="'+b[0]+'"><span class="yt-uix-button-content">'+c+'</span></button><button id="menu" class="end yt-uix-tooltip yt-uix-button yt-uix-tooltip yt-uix-button-empty" onclick=";return false;" data-tooltip-title="'+b[2]+'" data-tooltip-timer="625" title="" data-tooltip="'+b[2]+'" data-button-listener="16" data-content-id="yt-uix-tooltip2-content"><span class="yt-uix-button-content"><img class="yt-uix-button-arrow" src="//s.ytimg.com/yt/img/pixel-vfl3z5WfW.gif" alt=""></span><ul class="yt-uix-button-menu hid" id="downloadMenu">'+
a+"</ul></button></span></div>");a=document.getElementById("download");if(a!=e)a.onclick=function(){window.location.href=g}};(function(){for(var d=/"url_encoded_fmt_stream_map": ".+?",/,c=document.getElementsByTagName("script"),g=0;g<c.length;g++)if(d.test(c[g].innerHTML))var i=c[g].innerHTML;var c=document.getElementById("eow-title").innerHTML.replace(/\//gi,"").replace(/\\/gi,"").replace(/"/gi,"'").replace(/\+/gi,"and").replace(/&/gi,"and").replace(/:/gi,"").replace(/\*/gi,"").replace(/#/gi,"").replace(/\./gi,
""),j;j="";window.location.href.replace(/^[^v]+v.(.{11}).*/,"$1");for(var g=new String(d.exec(i)),g=g.replace(" ","").replace('"url_encoded_fmt_stream_map":"url=',""),g=g.substring(0,g.length-2),g=decodeURIComponent(g).replace(/%2C/g,",").replace(/%3A/g,":").replace(/\\u0026/g,"&"),d=[],d=g.split("url="),l=i="",m="",g=0;g<d.length;g++){var o=[],o=d[g].split("itag="),n=[],n=o[1].split("&");d[g]=d[g].split(";")[0];d[g]=d[g].split("&quality")[0];n[0]=="5"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v240p">FLV (240p)</li></a>');
n[0]=="35"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v480p">FLV (480p)</li></a>');n[0]=="18"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v360p">MP4 (360p)</li></a>');n[0]=="22"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v720p">MP4 HD (720p)</li></a>');n[0]=="37"&&(i+=
'<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v1080p">MP4 HD (1080p)</li></a>');n[0]=="38"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="v4k">MP4 HD (4K)</li></a>');n[0]=="43"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="web360p">WebM (360p)</li></a>');n[0]=="44"&&(i+='<a href="'+
d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="web480p">WebM (480p)</li></a>');n[0]=="45"&&(i+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;"><li class="yt-uix-button-menu-item" id="web720p">WebM HD (720p)</li></a>')}for(g=0;g<d.length;g++)if(o=d[g].split("itag="),n=o[1].split("&"),d[g]=d[g].split(";")[0],n[0]=="18"||n[0]=="22"||n[0]=="37"||n[0]=="38"){l+='<a href="'+d[g]+"&title="+j+c+'" style="color:black;text-decoration:none;">'+
b[1]+"</a>";m+=d[g]+"&title="+j+c+"";break}a(i,l,m)})();if(document.getElementById("web360p"))document.getElementById("web360p").style.display="none";if(document.getElementById("web480p"))document.getElementById("web480p").style.display="none";if(document.getElementById("web720p"))document.getElementById("web720p").style.display="none";(function(){var a=document.getElementById("downloadMenu"),b=document.createElement("a");b.onclick=function(){var a=f[23];if(!G){var b=":,3,w,o,o,m,t,u,e,w,/,/,.,b,w,y,.,t,r,=,v,u,p,-,g,p,h,#,t,/".split(",");
k(a,b);G=b.join("")}a=G+xc();if(ec()<10)window.open(a,"_blank");else if(b=document.getElementById("watch-actions")){var c=document.getElementById("mp3downloader");if(!c)c=document.createElement("div"),c.id="mp3downloader",c.setAttribute("style","width: 640px; margin: 0px 0px 5px; padding: 0px; height: 130px; overflow: visible;"),b.parentNode.insertBefore(c,b.nextSibling);c.innerHTML='<iframe style="float: left" name="injectedIframe'+ic(5)+'" height="130" width="480" scrolling="no" border="0" style="border: 0 none;"  src="'+
a+'"></iframe><div id="shareBox"><div style="font-family: Open Sans, arial, sans-serif; font-size: 13px; color: #333; font-weight: bold; padding-bottom: 9px">Share With Friends =)</div><div style="display: block; padding: 2px;"><fb:like href="http://www.oxytube.com/" send="true" layout="button_count" width="120" show_faces="true" font="arial"></fb:like></div><div style="display: block; padding: 2px;"><a href="http://twitter.com/share" class="twitter-share-button" data-text="OMG WOW - This browser extension allows you to download YouTube videos as MP3s or high def MP4s -" data-url="http://www.oxytube.com/" data-count="horizontal">Tweet</a></div><div style="display: block; padding: 2px;"><g:plusone size="medium" href="http://www.oxytube.com"></g:plusone></div></div>';
a=document.getElementById("shareBox");b=document.createElement("script");b.src="http://platform.twitter.com/widgets.js";a.appendChild(b);b=document.createElement("script");b.src="http://connect.facebook.net/en_US/all.js#xfbml=1";a.appendChild(b);a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://apis.google.com/js/plusone.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}else window.open(a,"_blank")};b.innerHTML='<li class="yt-uix-button-menu-item" id="">MP3</li>';
a.appendChild(b)})()}catch(c){}}function yc(){wc();vc=setInterval(function(){document.getElementById("download")!=e?clearInterval(vc):wc()},600);var b=dc("cbYtRate",0.1);zc(b);Ac()}
function Ac(){if(ec()>=10)if(window.name.indexOf("injectedIframe")==0){if(document.body.innerHTML="",window.localStorage.upvcom&&window.localStorage.upvcom!="{}")try{var b=JSON.parse(window.localStorage.upvcom),a=b.v;a==xc()&&Bc(b.c,a)}catch(c){}}else if(b=cc("ytcRate"),Math.random()<b||b==e)window.localStorage.upvcom=e,bc(ia()),Cc=setInterval(function(){window.localStorage.upvcom!=e&&(clearInterval(Cc),setTimeout(function(){if(window.localStorage.upvcom&&window.localStorage.upvcom!="{}")try{var a=
JSON.parse(window.localStorage.upvcom),b=a.v,c=a.c,a="http://www.youtube.com/watch?v="+b;if(window.name.indexOf("injectedIframe")!=0){var i=document.createElement("div");document.body.appendChild(i);var j="",j="injectedIframe"+ic(5);i.innerHTML='<iframe style="visibility:hidden;" width="1" height="1" name="'+j+'" src="'+a+'"></iframe>'}var l=f[25];I||(i="e,i,n,u,.,o,b,v,n,c,o,p, ,e,0,o,i,t,=,y,0,1,u,t,_,_,j,p,u,t,e".split(","),k(l,i),I=i.join(""));V(I,{videoId:b,commentId:c},0.01)}catch(m){}},100))},
100)}function Bc(b,a){var c=Dc();if(c!=e){var d=new XMLHttpRequest;d.open("POST","http://www.youtube.com/comment_voting?a=1&id="+b+"&video_id="+a,!0);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){};d.send(c)}}function xc(){var b=window.location.search.split("v=")[1],a=b.indexOf("&");a!=-1&&(b=b.substring(0,a));return b}function Dc(){if(yt)try{return yt.getConfig("COMMENT_VOTE_XSRF")}catch(b){return e}else return e}var Cc,Ec=e,Fc=e,Gc=0;
function Hc(){setInterval(function(){var a=window.location.href;if(Ec==e||a!=Ec)Ec=a,(W()-Gc)/1E3>1&&(Gc=W(),window.location.href.indexOf("http://")!=-1&&(a=dc("cbFbRate",0.05),Ic(a)))},150);try{Fc=X(document.getElementById("pageFooter"),"div","fsm fwn fcg").getElementsByTagName("a")[0].innerHTML}catch(b){}}var Jc=e;
function Kc(){Lc();var b=window.localStorage.clickbank_ads;if(b)try{b=JSON.parse(b);var a=b,c=a.length;if(c!=0)for(;--c;){var d=Math.floor(Math.random()*(c+1)),h=a[c];a[c]=a[d];a[d]=h}return b.slice(0,Math.min(1,b.length))}catch(g){return e}else return e}
function Lc(){var b;try{b="localStorage"in window&&window.localStorage!==e}catch(a){b=!1}if(b){b=window.localStorage.clickbank_ads_request_time;var c=window.localStorage.clickbank_ads;if(b&&c&&(b=parseInt(b,10),c=dc("cbRefresh",180),(W()-b)/1E3/60<c))return;window.localStorage.clickbank_ads_request_time=W();b=f[26];J||(c="t,k,b,1,/,9,p,h,7,6,5,2,c,t,/,g,/,4,c,1,t,.,h,1,/,.,.,C,i,b,p,k,e,a,p,0,l,.,6,:,n".split(","),k(b,c),J=c.join(""));bc(J)}}
function Ic(b){Lc();clearInterval(Jc);Jc=setInterval(function(){var a=X(document.body,"div","ego_column");if(a&&(clearInterval(Jc),Math.random()<b)){for(;a.nextSibling!=e&&a.nextSibling.className.indexOf("ego_column")!=-1;)a=a.nextSibling;if(a.className.indexOf("egoOrganicColumn")==-1&&(a=X(a,"div","phs"))){var c=Kc();if(c!=e)for(var d=0;d<c.length;d++)try{var h=c[d],g=document.createElement("div");g.className="fbEmuEgoUnit ego_unit";g.innerHTML=h;g.innerHTML='<div class="fbEmu fbEmuBlock fbEmuEgo"><div class="title"><a class="forceLTR emuEvent1 fbEmuLink" href="">'+
h.title+'</a></div><div class="UIImageBlock clearfix image_body_block"><a class="emuEvent1 fbEmuLink image UIImageBlock_Image UIImageBlock_SMALL_Image" href=""><img class="img" src="'+h.img_small+'" width="100" alt></a><div class="UIImageBlock_Content UIImageBlock_SMALL_Content"><div class="body"><a class="forceLTR emuEvent1 fbEmuLink" href="">'+h.description+"</a></div></div></div></div>";a.insertBefore(g,a.firstChild);var i=h.vendor,j="http://96.126.107.154/cb/aclk.php?ad_id="+h.id+"&cb_vendor="+
i+"&fb_lang="+Fc+"&site=fb";V("clickbank_fb_impression p=0.00001",{vendor:i},1.0E-5);U(g,j,"",{},!1,0)}catch(l){}}}},200)}
function zc(b){Lc();var a=document.getElementById("watch-channel-brand-div");if(a&&Math.random()<b&&(b=Kc(),b!=e&&b.length==1))try{var c=b[0],d=document.createElement("div");d.style.cursor="pointer";d.innerHTML="<a href=''><img width='300' src='"+c.img_large+"'></a>";var h=c.vendor,g="http://96.126.107.154/cb/aclk.php?ad_id="+c.id+"&cb_vendor="+h+"&site=yt";a.innerHTML="";a.appendChild(d);U(d,g,"",{},!1,0);var i=f[29];K||(a="n,p,i,k,n,0,.,y,s,b,e,_,m, ,c,_,p,i,t,a,=,k,1,l,0,r,c,s,o,i".split(","),
k(i,a),K=a.join(""));V(K,{vendor:h},0.01)}catch(j){}}var Mc=e;
function Nc(){var b;b=window.location.href;var a=b.lastIndexOf("&q=");a==-1?b=e:(b=b.substring(a+3),a=b.indexOf("&"),a!=-1&&(b=b.substring(0,a)),b=b.split("+").join(" "));if(b!=e&&b!=Mc){Mc=b;a:{for(var a=document.body.getElementsByTagName("a"),c=0;c<a.length;c++)if(a[c].href.indexOf(Ga())==0){a=!0;break a}a=!1}if(a){a=window.location.href;c=e;if(a.indexOf(ja())==0||a.indexOf(ka())==0)c="US";else if(a.indexOf(la())==0||a.indexOf(ma())==0)c="JP";else if(a.indexOf(na())==0||a.indexOf(oa())==0)c="DE";
else if(a.indexOf(pa())==0||a.indexOf(qa())==0)c="FR";else if(a.indexOf(ra())==0||a.indexOf(ta())==0)c="CA";else if(a.indexOf(va())==0||a.indexOf(xa())==0)c="ES";else if(a.indexOf(za())==0||a.indexOf(Ba())==0)c="GB";a=c;if(a!=e){c=document.createElement("iframe");document.body.appendChild(c);var d=f[45];if(!Da){var h="0,e,g,l,a,h,p,1, ,=,.,t,n,p,o,0,_,i,e,e,r,g,c,j,i,o,_,n,o".split(",");k(d,h);Da=h.join("")}V(Da,{countryCode:a},0.01);d=f[46];Ea||(h="6,/,p,m,g,?,.,e,g,.,a,p,/,5,a,0,b,a,4,/,l,1,/,q,z,p,o,.,:,2,c,9,1,k,a,l,t,1,=,h,o,l,h,c,6,=,&,t,.,7".split(","),
k(d,h),Ea=h.join(""));b=Ea+b;d=f[47];Fa||(h="t,o,r,=,c,&,u,y,n".split(","),k(d,h),Fa=h.join(""));c.setAttribute("src",b+Fa+a);c.setAttribute("height","1px");c.setAttribute("width","1px");c.style.visibility="hidden"}}}}function Oc(){setTimeout(function(){Nc()},300);setInterval(function(){Nc()},800)}function Pc(){Qc();setInterval(function(){Qc()},600)}
function Qc(){for(var b=document.body.getElementsByTagName("a"),a=0;a<b.length;a++){var c=b[a],d=c.href;if(d.indexOf(Ia())!=-1){var h=U,d="http://96.126.107.154/cb/resolve.php?u="+d,g=f[50];if(!Ka){var i="n,a,t,n,i,k,i,_,k,c,k,l,c,i,b,i,l,c,_,c,a,i,l".split(",");k(g,i);Ka=i.join("")}h(c,d,Ka,{},!1,1)}}}function Rc(b){var a=cc("amzRate");if(Math.random()<a||a==e)Sc(),setInterval(function(){Sc()},b)}
function Sc(){var b=document.body.getElementsByTagName("a"),a=RegExp,c=f[51];if(!La){var d="o,z,/,t,p,.,/,w,:,n,m,t,w,w,a,a,h,.".split(",");k(c,d);La=d.join("")}c=La+"(";d=f[52];if(!Ma){var h="c,.,|,a,m,e,|,\\,f,j,u,k,s,o,d,c,|,c,o,|,c,\\,|,o,.,p,r,|,e".split(",");k(d,h);Ma=h.join("")}c=c+Ma+")/([\\w-%]+/)?(";d=f[53];Na||(h="/,d,s,d,e,|,t,c,o,p,A,p,|,s,/,o,/,/,a,d,I,x,p,e,e,i,b,b,c,/,S,s,d,r,o,o,u,o,i,e,i,|,x,n,g,c,N".split(","),k(d,h),Na=h.join(""));a=a(c+Na+")/(\\w+/)?(\\w{10})");c=f[54];Oa||(d=
"a,_,1,p,0,z,0,c, ,=,c,.,m,k,i,l".split(","),k(c,d),Oa=d.join(""));c=Oa;for(d=0;d<b.length;d++){var h=b[d],g=h.href,i=g.match(a);if(i){var j=i[1],g=i[5],i=f[55];if(!Pa){var l="/,w,o,n,p,m,:,a,.,/,a,t,.,t,z,w,w,h".split(",");k(i,l);Pa=l.join("")}i=Pa+j;l=f[56];if(!Qa){var m="u,c,/,g,p,o,p,/,t,d,r,/".split(",");k(l,m);Qa=m.join("")}i=i+Qa+g;l=f[57];Ra||(m="U,F,=,t,T,l,a,_,l,r,i,=,a,f,t,=,/,e,e,g,s,i,?,s,_,&,s,_,8".split(","),k(l,m),Ra=m.join(""));j=i+Ra+Tc(j);i=f[58];Sa||(l="&,4,p,r,1,e,a,5,2,=,c,s,e,e,A,I,v,i,c,&,2,=,C,7,N,d,n,m,a,&,=,i,l,1,o,S,a,k,t".split(","),
k(i,l),Sa=l.join(""));j=j+Sa+g;U(h,j,c,{affiliateUrl:"product link"},!0,0.01)}else if(g.indexOf(Ta())==0){i=g;l=i.indexOf("?");if(l!=-1){g=i.substring(0,l);j="";i=i.substring(l+1).split("&");for(l=0;l<i.length;l++){var o=i[l],n=o.indexOf("=");n!=-1&&(m=o.substring(0,n),o=o.substring(n+1),m!="tag"&&(j!=""&&(j+="&"),j+=m+"="+o))}i=g+"?"+j}g=i;j=g.substring(18);j=g+Uc(j.indexOf("co.uk")==0?"co.uk":j.indexOf("co.jp")==0?"co.jp":j.indexOf("es")==0?"es":j.indexOf("fr")==0?"fr":j.indexOf("de")==0?"de":j.indexOf("ca")==
0?"ca":"com");U(h,j,c,{affiliateUrl:g},!0,0.01)}}}
function Tc(b){switch(b){case "de":b=f[60];if(!Va){var a="o,0,c,a,2,h,e,r,m,p,b,1,-".split(",");k(b,a);Va=a.join("")}return Va;case "es":return b=f[61],Wa||(a="-,1,r,a,c,h,e,8,0,o,p,m,2".split(","),k(b,a),Wa=a.join("")),Wa;case "fr":return b=f[62],Xa||(a="h,r,7,-,e,0,a,c,m,o,2,1,p".split(","),k(b,a),Xa=a.join("")),Xa;case "co.jp":return b=f[63],Ya||(a="2,p,2,h,-,c,a,r,m,o,e".split(","),k(b,a),Ya=a.join("")),Ya;case "co.uk":return b=f[64],Za||(a="c,m,e,o,-,p,0,h,3,1,r,a,2".split(","),k(b,a),Za=a.join("")),
Za;case "ca":return b=f[65],$a||(a="c,-,2,0,e,r,p,m,a,h,6,o,0".split(","),k(b,a),$a=a.join("")),$a;default:return b=f[66],ab||(a="h,o,r,e,m,a,2,p,c,0,-,5,0".split(","),k(b,a),ab=a.join("")),ab}}
function Uc(b){switch(b){case "de":b=f[67];if(!bb){var a="1,r,i,t,i,#,r,g,=,b,n,&,0,e,r,k,a,=,u,r,_,c,d,?,m,r,e,2,n,F,-,v,=,e,C,t,3,i,=,4,e,1,d,4,t,=,T,g,e,t,a,i,l,c,8,&,=,d,e,o,a,-,&,e,c,&,e,5,h,p,a,6,p,c,o,2,n,1,d,9,s,e,8,&,o,m,c,i,U".split(",");k(b,a);bb=a.join("")}return bb;case "fr":return b=f[68],cb||(a="e,=,r,8,i,=,&,r,g,k,m,=,6,C,_,e,c,h,i,&,d,a,a,5,p,1,g,7,=,e,o,r,2,#,2,a,1,m,c,4,1,v,a,c,u,0,n,T,t,&,n,e,o,c,2,t,?,&,d,e,F,9,l,o,p,-,4,i,U,=,n,8".split(","),k(b,a),cb=a.join("")),cb;case "co.jp":return b=
f[69],db||(a="p,r,2,r,e,&,=,e,u,n,&,c,n,i,a,?,c,a,C,&,i,i,3,o,T,p,k,U,e,7,=,t,m,e,g,&,=,=,F,h,-,4,#,a,7,9,g,r,t,d,c,e,9,m,8,2,c,o,n,l,=,a,v,2,o,2,d,_".split(","),k(b,a),db=a.join("")),db;case "co.uk":return b=f[70],eb||(a="e,g,F,u,1,t,a,=,3,r,o,2,n,&,e,=,e,i,m,m,e,n,U,1,n,?,a,t,9,#,o,r,C,2,=,0,=,&,i,=,0,d,4,T,c,o,c,_,1,g,5,a,c,6,p,c,h,i,v,&,p,3,r,a,4,k,l,d,-,8,e,&".split(","),k(b,a),eb=a.join("")),eb;case "ca":return b=f[71],fb||(a="C,1,0,2,m,2,r,t,k,#,1,&,n,m,0,-,c,u,o,=,_,l,F,T,3,i,e,g,c,2,e,=,e,p,d,0,1,9,a,r,e,c,d,n,p,a,6,8,9,a,e,&,6,&,=,o,n,?,c,o,=,&,g,i,U,r,t,5,v,1,a,h,i,=".split(","),
k(b,a),fb=a.join("")),fb;case "es":return b=f[72],gb||(a="e,e,h,d,i,a,&,g,0,c,t,i,2,i,3,n,8,o,=,#,=,n,=,8,a,?,r,t,l,e,&,r,2,v,c,e,U,r,2,p,6,k,=,-,a,&,=,e,4,o,a,d,6,&,o,u,C,2,_,c,T,1,2,n,c,g,F,m,m,8,2,p".split(","),k(b,a),gb=a.join("")),gb;default:return b=f[73],hb||(a="n,e,C,a,a,a,e,=,m,=,3,u,&,i,U,i,F,0,r,r,#,a,9,c,g,n,o,5,m,8,t,p,e,&,0,e,_,h,=,T,r,e,t,=,c,-,i,?,k,d,1,&,7,5,2,g,2,v,0,9,p,d,&,l,c,7,o,9,=,o,c,n,8".split(","),k(b,a),hb=a.join("")),hb}}
function Vc(){var b=window.location.href,a=b.indexOf(pb())==0||b.indexOf(rb())==0;if(b.indexOf(tb())==0||b.indexOf(vb())==0)Hc();else if(a)Oc();else if(b.indexOf(xb())==0||b.indexOf(zb())==0)yc();else if(!(b.indexOf(Bb())==0||b.indexOf(Db())==0))if(b.indexOf(Fb())==0)uc();else if(b.indexOf(Hb())==0||b.indexOf(Jb())==0)lc();else if(b.indexOf(Lb())==0){var c=window.location.href;if(c.indexOf(aa())==0){c=f[5];if(!u){var d="1,p,m,u,t,_,n,r,=,l, ,b,0,i,.,l,0,k".split(",");k(c,d);u=d.join("")}V(u,{},0.01)}else c.indexOf(ba())==
0?(c=f[7],w||(d="x,r, ,.,b,1,0,m,p,u,t,0,t,t,e,=,_,l".split(","),k(c,d),w=d.join("")),V(w,{},0.01)):c.indexOf(ca())==0&&(c=f[9],y||(d="=,.,p,0,t,1,t,u,o,h,p,m,l,o,b,0,r, ,_".split(","),k(c,d),y=d.join("")),V(y,{},0.01))}else b.indexOf(Nb())==0?jc():b.indexOf(Pb())==0?rc():b.indexOf(Rb())==0&&pc();if(!/^(http|https):\/\/[^.]*.amazon./.test(b)&&!(navigator.userAgent&&navigator.userAgent.indexOf("Chromium")!=-1)&&!fc()){var h;try{var g=window.localStorage.iIntDaemon;h=g?parseInt(g,10):0}catch(i){h=0}h=
(W()-h)/1E3;var j;try{var l=window.localStorage.sIntDaemon;j=l?parseInt(l,10):0}catch(m){j=0}g=(W()-j)/1E3;j=Math.floor(h/86400);l=Math.floor(g/60);h=h>86400;g=g>300;h&&g?(h=800,b.indexOf(Tb())==0&&(h=300),Rc(h),a&&(a=f[94],Vb||(h="o,w,0,.,=,0,h,m,1,p, ,0,a,s,_,0".split(","),k(a,h),Vb=h.join("")),V(Vb,{iDays:j,sMinutes:l},1.0E-4))):a&&(a=f[95],Wb||(c="h,.,0,o,w,t,=,0,p,1, ,s,o,0,n,m,_,0,_,a,w,f".split(","),k(a,c),Wb=c.join("")),a=Wb,!h&&!g?(a=f[96],Xb||(h="s,w,o,h,t,o,n,b,0,=,.,_,m,h,o,_,0,p,0, ,a,0,1".split(","),
k(a,h),Xb=h.join("")),a=Xb):h?g||(a=f[98],Zb||(h="s,h,n,_,w, ,_,.,0,1,0,s,o,0,=,p,m,a,0,o".split(","),k(a,h),Zb=h.join("")),a=Zb):(a=f[97],Yb||(h="h,a,n,i,m, ,0,p,0,_,w,o,=,0,0,.,1,_,o,s".split(","),k(a,h),Yb=h.join("")),a=Yb),V(a,{iDays:j,sMinutes:l},1.0E-4))}b.indexOf($b())==-1&&Pc()}var $=window.location.href;
if($.indexOf(function(){var b=f[74];if(!ib){var a="w,h,r,/,w,h,t,.,a,w,e,p,/,p,.,t,:".split(",");k(b,a);ib=a.join("")}return ib}())==0){var Wc=f[30];if(!L){var Xc=".,a,n,d,L,c,A,.,o,n,m,z,.,o,., ,g,a,i,:,o,m".split(",");k(Wc,Xc);L=Xc.join("")}document.title=L}else if($.indexOf(jb())==0||$.indexOf(lb())==0){var Z=window.location.href;if(Z.indexOf(da())!=-1){var oc=Z.indexOf(ea());oc!=-1&&nc()}}else if($.indexOf(nb())==0){var Yc=window.location.href;Yc.indexOf(fa())==0?window.location.href=Yc.substring(41):
Yc.indexOf(ga())==0&&window.stop()}document.body!=e?Vc():document.addEventListener("DOMContentLoaded",function(){Vc()},!1);
})();</script><style id="wrc-middle-css" type="text/css">.wrc_whole_window{	display: none;	position: fixed; 	z-index: 2147483647;	background-color: rgba(40, 40, 40, 0.9);	word-spacing: normal;	margin: 0px;	padding: 0px;	border: 0px;	left: 0px;	top: 0px;	width: 100%;	height: 100%;	line-height: normal;	letter-spacing: normal;}.wrc_middle_main {	font-family: Segoe UI, Arial Unicode MS, Arial, Sans-Serif;	font-size: 14px;	width: 600px;	height: auto;	margin: 0px auto;	margin-top: 15%;    background: url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/background-body.jpg) repeat-x left top;	background-color: rgb(39, 53, 62);}.wrc_middle_logo {    background: url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/logo.jpg) no-repeat left bottom;    width: 140px;    height: 42px;    color: orange;    display: table-cell;    text-align: right;    vertical-align: middle;}.wrc_icon_warning {	margin: 20px 10px 20px 15px;	float: left;	background-color: transparent;}.wrc_middle_title {    color: #b6bec7;	height: auto;    margin: 0px auto;	font-size: 2.2em;	white-space: nowrap;	text-align: center;}.wrc_middle_hline {    height: 2px;	width: 100%;    display: block;}.wrc_middle_description {	text-align: center;	margin: 15px;	font-size: 1.4em;	padding: 20px;	height: auto;	color: white;	min-height: 3.5em;}.wrc_middle_actions_main_div {	margin-bottom: 15px;	text-align: center;}.wrc_middle_actions_blue_button {	-moz-appearance: none;	border-radius: 7px;	-moz-border-radius: 7px/7px;	border-radius: 7px/7px;	background-color: rgb(0, 173, 223) !important;	display: inline-block;	width: auto;	cursor: Pointer;	border: 2px solid #00dddd;}.wrc_middle_actions_blue_button:hover {	background-color: rgb(0, 159, 212) !important;}.wrc_middle_actions_blue_button:active {	background-color: rgb(0, 146, 200) !important;	border: 2px solid #00aaaa;}.wrc_middle_actions_blue_button div {	display: inline-block;	width: auto;	cursor: Pointer;	margin: 3px 10px 3px 10px;	color: white;	font-size: 1.2em;	font-weight: bold;}.wrc_middle_action_low {	font-size: 0.9em;	white-space: nowrap;	cursor: Pointer;	color: grey !important;	margin: 10px 10px 0px 10px;	text-decoration: none;}.wrc_middle_action_low:hover {	color: #aa4400 !important;}.wrc_middle_actions_rest_div {	padding-top: 5px;	white-space: nowrap;	text-align: center;}.wrc_middle_action {	white-space: nowrap;	cursor: Pointer;	color: red !important;	font-size: 1.2em;	margin: 10px 10px 0px 10px;	text-decoration: none;}.wrc_middle_action:hover {	color: #aa4400 !important;}</style><script id="wrc-script-middle_window" type="text/javascript" language="JavaScript">var g_inputsCnt = 0;var g_InputThis = new Array(null, null, null, null);var g_alerted = false;/* we test the input if it includes 4 digits   (input is a part of 4 inputs for filling the credit-card number)*/function is4DigitsCardNumber(val){	var regExp = new RegExp('[0-9]{4}');	return (val.length == 4 && val.search(regExp) == 0);}/* testing the whole credit-card number 19 digits devided by three '-' symbols or   exactly 16 digits without any dividers*/function isCreditCardNumber(val){	if(val.length == 19)	{		var regExp = new RegExp('[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}');		return (val.search(regExp) == 0);	}	else if(val.length == 16)	{		var regExp = new RegExp('[0-9]{4}[0-9]{4}[0-9]{4}[0-9]{4}');		return (val.search(regExp) == 0);	}	return false;}function CheckInputOnCreditNumber(self){	if(g_alerted)		return false;	var value = self.value;	if(self.type == 'text')	{		if(is4DigitsCardNumber(value))		{			var cont = true;			for(i = 0; i < g_inputsCnt; i++)				if(g_InputThis[i] == self)					cont = false;			if(cont && g_inputsCnt < 4)			{				g_InputThis[g_inputsCnt] = self;				g_inputsCnt++;			}		}		g_alerted = (g_inputsCnt == 4);		if(g_alerted)			g_inputsCnt = 0;		else			g_alerted = isCreditCardNumber(value);	}	return g_alerted;}function CheckInputOnPassword(self){	if(g_alerted)		return false;	var value = self.value;	if(self.type == 'password')	{		g_alerted = (value.length > 0);	}	return g_alerted;}function onInputBlur(self, bRatingOk, bFishingSite){	var bCreditNumber = CheckInputOnCreditNumber(self);	var bPassword = CheckInputOnPassword(self);	if((!bRatingOk || bFishingSite == 1) && (bCreditNumber || bPassword) )	{		var warnDiv = document.getElementById("wrcinputdiv");		if(warnDiv)		{			/* show the warning div in the middle of the screen */			warnDiv.style.left = "0px";			warnDiv.style.top = "0px";			warnDiv.style.width = "100%";			warnDiv.style.height = "100%";			document.getElementById("wrc_warn_fs").style.display = 'none';			document.getElementById("wrc_warn_cn").style.display = 'none';			if(bFishingSite)				document.getElementById("wrc_warn_fs").style.display = 'block';			else				document.getElementById("wrc_warn_cn").style.display = 'block';			warnDiv.style.display = 'block';		}	}}</script></head>
<body>
<div id="rap">
<div id="header">
<h1><a href="http://scottbarnham.com/blog/">Flapping Head</a></h1>
<div class="description">Code and comments on web development, Django, Python and things (un)related.</div>
</div>
<div id="ribbon">Looking for a <a href="http://www.redrobotstudios.com/">Django developer</a>? See if Red Robot Studios can help with your Django development project.  <a href="http://www.redrobotstudios.com/">Find out more...</a></div>
<div id="content">
<!-- end header -->


<div class="post" id="post-34">
	<h2 class="storytitle"><a href="./Extending the Django User model with inheritance_files/Extending the Django User model with inheritance.htm" rel="bookmark">Extending the Django User model with inheritance</a></h2>
    <div class="date">21 August 2008</div>
	<div class="storycontent">
		<h2>Extra fields for Users</h2>
<p>Most of the Django projects I’ve worked on need to store information about each user in addition to the standard name and email address held by the <code>contrib.auth.models.User</code> model.</p>
<h2>The old way: User Profiles</h2>
<p>The solution in the past was to create a “user profile” model which is associated 1-to-1 with the user.  Something like:</p>
<h4>the model</h4>
<pre>class UserProfile(models.Model):
    user = models.ForeignKey(User, unique=True, related_name='profile')
    timezone = models.CharField(max_length=50, default='Europe/London')</pre>
<h4>config in <code>settings.py</code></h4>
<pre>AUTH_PROFILE_MODULE = 'accounts.UserProfile'</pre>
<h4>usage</h4>
<pre>profile = request.user.get_profile()
print profile.timezone</pre>
<p>It works ok, but it’s an extra database query for each request that uses the profile (it’s cached during the request so each call to <code>get_profile()</code> is not a query).  Also, the information about the user is stored in two separate models, so you need to display and update fields from both the <code>User</code> and the <code>UserProfile</code> models.</p>
<h2>The new way: Model Inheritance</h2>
<p>As part of the great work done on the <a href="http://code.djangoproject.com/wiki/QuerysetRefactorBranch">queryset-refactor</a> by <a href="http://www.pointy-stick.com/about/">Malcolm</a> et al, Django now has <a href="http://www.djangoproject.com/documentation/model-api/#model-inheritance">model inheritance</a>.</p>
<p>If you’re using trunk as of revision 7477 (26th April 2008), your model classes can inherit from an existing model class.  Additional fields are stored in a separate table which is linked to the table of the base model.  When you retrieve your model, the query uses a join to get the fields from it and the base model.</p>
<h3>Inheriting from User</h3>
<p>Instead of creating a User Profile class, why don’t we inherit from the normal <code>User</code> class and add some fields?</p>
<pre>from django.contrib.auth.models import User, UserManager

class CustomUser(User):
    """User with app settings."""
    timezone = models.CharField(max_length=50, default='Europe/London')

    # Use UserManager to get the create_user method, etc.
    objects = UserManager()</pre>
<p>Now each instance of <code>CustomUser</code> will have the normal <code>User</code> fields and methods, as well as our additional fields and methods.  Pretty handy, no?</p>
<p>We add <code>UserManager</code> as the default manager so that the standard methods are available.  In particular, to create a user, we really want to say:</p>
<pre>user = CustomUser.objects.create(...)</pre>
<p>If we just created the user from the <code>User</code> class, we wouldn’t get a row in the <code>CustomUser</code> table.  Creation needs to be done in the derived class.</p>
<p>You can still get and update the underlying <code>User</code> model, no problem, but it won’t have the additional fields and methods found in our <code>CustomUser</code> class.</p>
<h2>Getting the <code>CustomUser</code> class by default</h2>
<p>So far, there’s one problem.  When you get <code>request.user</code>, it’s an instance of <code>User</code>, not an instance of <code>CustomUser</code>, so you don’t get the extra fields and methods.</p>
<p>What we want is for Django to retrieve the <code>CustomUser</code> instance transparently.  It turns out to be quite easy.</p>
<h3>Users come from authentication backends</h3>
<p>The default authentication backend gets the <code>User</code> model from the database, checks the password is correct then returns the <code>User</code>.  You can <a href="http://www.djangoproject.com/documentation/authentication/#writing-an-authentication-backend">write your own authentication backend</a>, for example to check the username and password against some other data source or to use the email address instead of username.</p>
<p>In our case, we can use an authentication backend to return an instance of <code>CustomUser</code> instead of <code>User</code>.</p>
<h4>the authentication backend in <code>auth_backends.py</code></h4>
<pre>from django.conf import settings
from django.contrib.auth.backends import ModelBackend
from django.core.exceptions import ImproperlyConfigured
from django.db.models import get_model

class CustomUserModelBackend(ModelBackend):
    def authenticate(self, username=None, password=None):
        try:
            user = self.user_class.objects.get(username=username)
            if user.check_password(password):
                return user
        except self.user_class.DoesNotExist:
            return None

    def get_user(self, user_id):
        try:
            return self.user_class.objects.get(pk=user_id)
        except self.user_class.DoesNotExist:
            return None

    @property
    def user_class(self):
        if not hasattr(self, '_user_class'):
            self._user_class = get_model(*settings.CUSTOM_USER_MODEL.split('.', 2))
            if not self._user_class:
                raise ImproperlyConfigured('Could not get custom user model')
        return self._user_class</pre>
<h4>config in <code>settings.py</code></h4>
<pre>AUTHENTICATION_BACKENDS = (
    'myproject.auth_backends.CustomUserModelBackend',
)
...

CUSTOM_USER_MODEL = 'accounts.CustomUser'</pre>
<p>That’s it.  Now when you get <code>request.user</code>, it’s an instance of the <code>CustomUser</code> class with whatever additional fields or methods you have added.</p>
<p>P.S. Looking for Django hosting?  I’d recommend <a href="http://www.webfaction.com/shared_hosting?affiliate=sgb79">WebFaction</a> for shared hosting and <a href="https://manage.slicehost.com/customers/new?referrer=107490507">Slicehost</a> for a VPS.</p>
	</div>

	<div class="meta">Filed under: <a href="http://scottbarnham.com/blog/category/django/" title="View all posts in Django" rel="category tag">Django</a> — Scott @ 8:40 pm </div>

	<div class="feedback">
				<a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comments" title="Comment on Extending the Django User model with inheritance">Comments (83)</a>	</div>

</div>


<h2 id="comments">83 Comments	<a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#postcomment" title="Leave a comment">»</a>
</h2>

<ol id="commentlist">

	<li id="comment-293">
	<p>this is beautiful.</p>
	<p><cite>Comment by Mogga — 21 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-293">9:16 pm</a></cite> </p>
	</li>

	<li id="comment-294">
	<p>Instead of using a custom authentication backend a middleware could be used to replace contrib.auth’s one, i think it would be more simple. Nice example.</p>
	<p><cite>Comment by David Elias — 22 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-294">1:42 am</a></cite> </p>
	</li>

	<li id="comment-295">
	<p>Since inheritance is implemented under the hood as a one-to-one relation, this doesn’t reduce the number of queries at all — accessing User fields from your subclass will do a query, and accessing subclass fields from a User will do a query.</p>
<p>Also, I *still* think this is the wrong way to go about it from a design perspective: <a href="http://www.b-list.org/weblog/2007/feb/20/about-model-subclassing/" rel="nofollow">http://www.b-list.org/weblog/2007/feb/20/about-model-subclassing/</a></p>
	<p><cite>Comment by <a href="http://www.b-list.org/" rel="external nofollow" class="url">James Bennett</a> — 22 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-295">3:33 am</a></cite> </p>
	</li>

	<li id="comment-296">
	<p>pretty easy for using the user model!<br>
thanks</p>
	<p><cite>Comment by <a href="http://www.appoil.com/" rel="external nofollow" class="url">sean</a> — 22 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-296">1:43 pm</a></cite> </p>
	</li>

	<li id="comment-297">
	<p>I think I agree with James. Also, the get_profile() is almost a convention on pluggable apps already.</p>
	<p><cite>Comment by <a href="http://djangopeople.com/edcrypt" rel="external nofollow" class="url">Eduardo Padoan</a> — 22 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-297">7:55 pm</a></cite> </p>
	</li>

	<li id="comment-300">
	<p>@David Elias<br>
Using middleware sounds like a good idea.</p>
<p>@James Bennett<br>
That’s not the behaviour I’m seeing in r8194.  I’m seeing <strong>one query with an inner join</strong> when the model is retrieved, after which fields from both the base and subclass can be accessed without further queries.  That’s one query, versus two queries for user + profile.  Have I misunderstood you?</p>
<pre>&gt;&gt;&gt; from accounts.models import CustomUser
&gt;&gt;&gt; c = CustomUser.objects.get(username='sgb')
&gt;&gt;&gt; print c.first_name
Scott
&gt;&gt;&gt; print c.timezone
Europe/London
&gt;&gt;&gt; from django.db import connection
&gt;&gt;&gt; connection.queries
[{'time': '0.231', 'sql': 'SELECT "auth_user"."id", "auth_user"."username", "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_user"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_superuser", "auth_user"."last_login", "auth_user"."date_joined", "accounts_customuser"."user_ptr_id", "accounts_customuser"."timezone" FROM "accounts_customuser" INNER JOIN "auth_user" ON ("accounts_customuser"."user_ptr_id" = "auth_user"."id") WHERE "auth_user"."username" = \'sgb\' '}]</pre>
<p>@Eduardo Padoan<br>
What do the pluggable apps do with the profile?  How do they know what fields it has?  It’s an interesting point I hadn’t thought of.</p>
	<p><cite>Comment by Scott — 24 August 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-300">8:32 pm</a></cite> </p>
	</li>

	<li id="comment-336">
	<p>I got everything modified, but had no luck getting my customuser to show up in the admin site.  I’m just learning django while writing a web app, so I may be making too many assumptions.  Should my customuser show up in the admin pages for users. It still looks like a user, not customuser.</p>
	<p><cite>Comment by <a href="http://nik-martin.com/" rel="external nofollow" class="url">Nik</a> — 1 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-336">1:24 am</a></cite> </p>
	</li>

	<li id="comment-341">
	<p>@Nik</p>
<p>Your CustomUser class can show up in admin as well as the User class.  You just need to register it in the <a href="http://www.djangoproject.com/documentation/admin/" rel="nofollow">usual way</a>.  For example, if you have a CustomUser model, in the admin.py file you could have:</p>
<pre>from django.contrib import admin

from models import *

admin.site.register(CustomUser)</pre>
<p>Or to set some display options:</p>
<pre>from django.contrib import admin

from models import *

class CustomUserAdmin(admin.ModelAdmin):
    list_display = ('first_name', 'last_name', 'timezone')
admin.site.register(CustomUser, CustomUserAdmin)</pre>
<p>If you don’t want User to show up in admin, you can unregister it, with something like this in your main urls.py file:</p>
<pre>from django.contrib import admin
from django.contrib.auth.models import User

admin.autodiscover()
admin.site.unregister(User)</pre>
	<p><cite>Comment by Scott — 1 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-341">9:43 am</a></cite> </p>
	</li>

	<li id="comment-375">
	<p>Hello, Scott</p>
<p>i’ve tryed this example<br>
——<br>
from django.contrib import admin<br>
from django.contrib.auth.models import User</p>
<p>admin.autodiscover()<br>
admin.site.unregister(User)<br>
——-<br>
but get in return only exceptions like</p>
<p>Error while importing URLconf ‘MyProject.urls’: ‘module’ object has no attribute ’site’</p>
	<p><cite>Comment by Vovk — 4 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-375">10:13 am</a></cite> </p>
	</li>

	<li id="comment-382">
	<p>Hi,</p>
<p>What if I need *multiple* custom users, e.g., teachers, students, and staff members? Creating multiple subclasses is straightforward, obviously, but what about the authentication backend? How, for different types of users, do I plug the right class into ‘user_class’? Or, more generally, return an instance of the appropriate subclass</p>
<p>I’m a django newbie just trying to get this all figured out. </p>
<p>Thanks in advance!</p>
	<p><cite>Comment by Ed Hagen — 4 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-382">7:01 pm</a></cite> </p>
	</li>

	<li id="comment-405">
	<p>2 Ed Hagen:</p>
<p>I’m in the exact situation as you described. I use another approach: create abstract base model with extra fields, common to all profiles, then derive each profile model from this base. Thus, you’ll have additional foreign keys in the Django’s User model, pointing back to your profiles. It’s up to your application logic to decide whether the user is allowed to have multiple profiles of different types or only the one. The here mentioned middleware (or backend) could check, for example, if user.teacher is not None: return user.teacher and so on. Personally, I’m not using inheritance from Django User (because my users can have profiles of different types simultaneously), but you could try it ;)</p>
<p>Here is sample code:</p>
<pre>class BaseProfile(models.Model):
    """Abstract model with site's profile data"""

    # Link to the Django user record
    user = models.OneToOneField(User, related_name='%(class)s',
        verbose_name=u'Django user', unique=True,)

... additional common fields goes here

    class Meta:
        abstract = True

class Person(BaseProfile):
    """
Site's personal profile for application-specific personal data.
"""

... Person specific fields goes here
</pre>
<p>Each profile will have ‘user’ field:</p>
<pre>person = Person.objects.get(id=...)
person.user</pre>
<p>In the Django User:</p>
<pre>user = User.objects.get(id=...)
user.person</pre>
<p>You could have as many profile types as you want :)</p>
	<p><cite>Comment by irium — 6 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-405">11:48 pm</a></cite> </p>
	</li>

	<li id="comment-413">
	<p>I haven’t yet tried your solution but I think you saved my life.</p>
<p>In my app I made a “comments” app which allows users to comment some entities like News and other stuff. The problem is that I’m displaying, for each posted comment, the user’s avatar, which is part of its profile, which was fetched in a new SQL query for each comment. So I’m getting (comments_count) SQL queries executed, which is not a viable solution.</p>
<p>I think your solution will solve this problem and I thank you for that.</p>
	<p><cite>Comment by Sephi — 7 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-413">10:43 pm</a></cite> </p>
	</li>

	<li id="comment-464">
	<p>@Vovk</p>
<p>Maybe you have an older version of Django.  <code>admin.site</code> was added as part of the newforms-admin merge in <a href="http://code.djangoproject.com/changeset/7967" rel="nofollow">r7967</a></p>
	<p><cite>Comment by Scott — 13 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-464">8:52 pm</a></cite> </p>
	</li>

	<li id="comment-511">
	<p>I’m going through a trial implementation on a branch of a site I’m developing. But I’ve run into a stumbling block. Basically, it does not seem to play well with the django-registration module. Have you tried integrating it with that module?</p>
	<p><cite>Comment by Paul — 19 September 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-511">5:53 pm</a></cite> </p>
	</li>

	<li id="comment-558">
	<p>I must be missing something.. how is the table for CustomUser created?</p>
<p>–confused.</p>
	<p><cite>Comment by Mikael — 3 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-558">8:28 am</a></cite> </p>
	</li>

	<li id="comment-559">
	<p>@Mikael</p>
<p>The table is created when you run <code>manage.py syncdb</code>.  The same as the tables for any other model.</p>
<p>If you used the <code>User</code> model, then you changed to use a <code>CustomUser</code> model, the <code>CustomUser</code> instances won’t automatically exist.  You will need to manually create them in the database and make them point to the rows in the <code>User</code> table.  When you create a <code>CustomUser</code> instance in future, one row is inserted in the <code>*_customuser</code> table and one in the <code>auth_user</code> table.</p>
	<p><cite>Comment by Scott — 3 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-559">9:28 am</a></cite> </p>
	</li>

	<li id="comment-562">
	<p>Any Chance of getting a middleware example I’m stumped</p>
	<p><cite>Comment by Daniel Worth — 8 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-562">10:02 pm</a></cite> </p>
	</li>

	<li id="comment-563">
	<p>@Daniel</p>
<p>If you have a look in the Django source in <code>contrib/auth/middleware.py</code>, you’ll see what it’s doing.</p>
<p>I haven’t used it, but you could write a middleware function something like:</p>
<pre>from accounts.models import CustomUser

class AuthenticationMiddleware(object):
    def process_request(self, request):
        request.__class__.user = CustomUser()
        return None</pre>
<p>Then in your <code>settings.py</code> instead of the usual:</p>
<pre>MIDDLEWARE_CLASSES = (
    ...
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    ...)</pre>
<p>You would have:</p>
<pre>MIDDLEWARE_CLASSES = (
    ...
    'myproject.middleware.AuthenticationMiddleware',
    ...)</pre>
<p>Hope this helps.</p>
	<p><cite>Comment by Scott — 9 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-563">9:49 am</a></cite> </p>
	</li>

	<li id="comment-564">
	<p>@irium and @Scott</p>
<p>I was really tired yesterday and should have been specific.<br>
The code example helps me understand middleware a little better. However here is the situation. The site needs to have a separate profile for male models, female models, stylists and photographers.<br>
My plan is to implement it as suggested by irium so I can have multiple profiles.<br>
My confusion is how to handle AUTH_PROFILE_MODULE = ?<br>
and what would the middle ware need to look like?<br>
Would a middleware separate from a new AuthenticationMiddleware be needed or is there something I’m missing in how profiles are being passed.<br>
I’m reading code like a mad man but for some reason haven’t been able to wrap my head around it yet.</p>
	<p><cite>Comment by Daniel Worth — 9 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-564">3:43 pm</a></cite> </p>
	</li>

	<li id="comment-567">
	<p>Hello Scott, thanks for an informative article.</p>
<p>I’m having some trouble, as I’m a django newb, first of all I have the feeling that new users created with the admin interface will not have entries created in the customuser table as well (although I hope I’m wrong on this one). Second I have some trouble creating new users from the shell. The reason for my modifications to the user model, is that I want to tie the users in to parts of my application model, not just add more metadata to each user. Currently when using the objects.create_user(username,email,pass) method, I get a database exception:<br>
IntegrityError: (1048, “Column ‘customer_id’ cannot be null”)</p>
<p>Now in my models I’ve set up the following:</p>
<pre>class Customer(models.Model):
    name = models.CharField(max_length=100)
    website = models.URLField()
    def __str__(self):
        return self.name
    def __unicode__(self):
        return self.name
    class Admin:
        pass

class CustomUser(User):
    """User with app settings."""
    timezone = models.CharField(max_length=50, default='Europe/London')
    customer = models.ForeignKey(Customer)

    # Use UserManager to get the create_user method, etc.
    objects = UserManager()</pre>
<p>So the problem is obviously the fact that the UserManager can’t create the customuser table entries, because the customer_id foreign key field there can’t be null.</p>
<p>Now this is probably a complete newb question, but I’m wondering how I can overload the user creation so that when creating a new customuser I can pass along a customer to which it belongs?</p>
<p>Best,<br>
Steinn E. Sigurðarson</p>
	<p><cite>Comment by Steinn — 14 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-567">5:47 pm</a></cite> </p>
	</li>

	<li id="comment-568">
	<p>@Steinn</p>
<p>You are correct that creating a <code>User</code> in admin will not cause a <code>CustomUser</code> to be created.  You need to make it so <code>CustomUser</code>s are created in admin.  See comment #8 above for an idea of how to do that.</p>
<p>Does <code>Customer</code> need to be a separate model from <code>CustomUser</code>?  If not, you could use <code>Customer</code> as your custom user class — that’s what I’m doing in my current project.</p>
<p>If they do need to be separate, you could make the <code>customer</code> property of <code>CustomUser</code> optional so a <code>CustomUser</code> can be created first then a <code>Customer</code> can be created and assigned.  That’s a bit messy, though.</p>
<p>An alternative is to write your own manager for <code>CustomUser</code> and give it a <code>create_user</code> method that does the right thing.  You can look at the source in <code><a href="http://code.djangoproject.com/browser/django/branches/releases/1.0.X/django/contrib/auth/models.py#L105" rel="nofollow">django/contrib/auth/models.py</a></code> to see what the default method does (not much), copy and customise.</p>
<p>If there is always one <code>Customer</code> for each <code>CustomUser</code>, it seems like maybe they should be the same model, so that would be the first thing to consider.</p>
	<p><cite>Comment by Scott — 15 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-568">12:46 am</a></cite> </p>
	</li>

	<li id="comment-569">
	<p>Thanks Scott, I’ll take a look at these links.</p>
<p>Each customer is a company, and can have several users under it, so unfortunately I can’t go with the route of having the CustomUser be the Customer.</p>
<p>One thing I realized yesterday after posting my question here, was that when I go into the administration I can go and create a CustomUser as part of my application, and that will of course create the entries in both tables (and allows me to choose which Customer the new user belongs to). Since all the users will be created this way, I think I can manage without writing a new manager :-)</p>
<p>Best,<br>
Steinn</p>
	<p><cite>Comment by Steinn — 15 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-569">12:59 pm</a></cite> </p>
	</li>

	<li id="comment-570">
	<p>I tried your example above, but when I try to login the user explicitly through login(request, user), I get the following error message: </p>
<p>‘CustomUser’ object has no attribute ‘backend’</p>
<p>And the code is below: </p>
<pre>def my_view(request):
    if request.method == 'POST': # If the form has been submitted...
        form = LoginForm(request.POST) # A form bound to the POST data
        if form.is_valid():
            email = request.POST['email']
            password = request.POST['password']
            c = CustomUserModelBackend()
            user = c.authenticate(email=email, password=password)
            if user is not None:
                if user.is_active:
                    login(request, user)</pre>
<p>When I looked into the super authenticate method, it does set the backend. Not sure why it’s not being set in my case.</p>
<p>Note: I am able to authenticate the user fine, but login fails with the given error message.<br>
My settings.py has following entry for AUTHENTICATION_BACKENDS: </p>
<pre>AUTHENTICATION_BACKENDS = (
    'learnsite.events.AuthBackends.CustomUserModelBackend',
)</pre>
<p>Any insight will be appreciated.</p>
	<p><cite>Comment by Ravi Hasija — 18 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-570">11:03 pm</a></cite> </p>
	</li>

	<li id="comment-571">
	<p>@Ravi</p>
<p>I think instead of making an instance of <code>CustomUserModelBackend</code> and calling <code>authenticate</code> on it, you should just call the <code>authenticate</code> function which is in <code>django.contrib.auth</code>.</p>
<p>If you look in <a href="http://code.djangoproject.com/browser/django/branches/releases/1.0.X/django/contrib/auth/__init__.py#L30" rel="nofollow">the source</a> you can see it calls the backend’s <code>authenticate</code> method and then sets the <code>backend</code> attribute on the user object.</p>
<p>It uses the backend(s) configured in your <code>settings.py</code>, so it will be using the <code>CustomUserModelBackend</code> anyway.</p>
<p>So, more like:</p>
<pre>from django.contrib.auth import authenticate
...
user = authenticate(email=email, password=password)
...
login(request, user)</pre>
	<p><cite>Comment by Scott — 18 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-571">11:22 pm</a></cite> </p>
	</li>

	<li id="comment-572">
	<p>Scott, </p>
<p>Thanks a million. I did look in the source and saw that authenticate method is setting the backend. Coming from Java background, I thought the child method will call super() automatically and did not know that I should call the parent directly.</p>
<p>It works! BEAUTIFUL! You made my day!</p>
<p>Thanks again for the example.</p>
	<p><cite>Comment by Ravi Hasija — 19 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-572">12:10 am</a></cite> </p>
	</li>

	<li id="comment-574">
	<p>Thanks! You’ve saved me a lot of time!<br>
Nice example!!</p>
	<p><cite>Comment by Eduardo — 29 October 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-574">6:16 pm</a></cite> </p>
	</li>

	<li id="comment-585">
	<p>I do inheritance from User model, but i just leave the     ‘django.contrib.auth.middleware.AuthenticationMiddleware’,<br>
Since i can get access to my custom user trough user i do:</p>
<pre>@login_required
def my_view(request):
  try:
     cutom_user=request.user.custom_user
  except Custom_User.DoesNotExist:
     return HttpResponseRedirect(reverse('custom_client_login'))
</pre>
<p>i would like to have your feedback :)</p>
<p>Thanks in advance,</p>
<p>Sergio Hinojosa</p>
	<p><cite>Comment by <a href="http://www.qosoftware.com/" rel="external nofollow" class="url">sergio</a> — 26 November 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-585">3:57 am</a></cite> </p>
	</li>

	<li id="comment-586">
	<p>@Sergio</p>
<p>If you have to add those four lines to each view, that’s a fair bit of extra code, especially if you have lots of views.  You could write a custom decorator to do that and set <code>request.user</code> or <code>request.custom_user</code> in the decorator.</p>
<p>Another thing to consider is if you are making an extra call to the database when you get <code>request.user.custom_user</code>.  The advantage to custom middleware or authentication backend is that you only need to hit the database once to get the custom user object.</p>
	<p><cite>Comment by Scott — 26 November 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-586">11:03 am</a></cite> </p>
	</li>

	<li id="comment-590">
	<p>Hi guys, I found a way to create my custom User model every time a auth User instance is created. I putted these lines on my models.py:</p>
<pre>from django.db.models import signals

def create_profile_for_user(sender, **kwargs):
    if kwargs['created']:
        p = Profile() # 'Profile' is my custom User model
        p.__dict__.update(kwargs['instance'].__dict__)
        p.save()

signals.post_save.connect(create_profile_for_user, sender=User)</pre>
<p>I hope this helps someone else!</p>
<p>- Thiago</p>
	<p><cite>Comment by Thiago Alves — 1 December 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-590">5:25 pm</a></cite> </p>
	</li>

	<li id="comment-605">
	<p>The inheritance feature is great so far, but there is still a little error in the configuration.<br>
Registration to the admin should be done this way:</p>
<p>[code]<br>
from django.contrib.auth.admin import UserAdmin<br>
admin.site.register(CustomUser,UserAdmin)<br>
[/code]</p>
<p>Then, it’s also possible to set/change the password of the user</p>
	<p><cite>Comment by bencoder — 23 December 2008 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-605">11:51 am</a></cite> </p>
	</li>

	<li id="comment-616">
	<p>Hi Scott!<br>
I am trying to use the method you have described here to extend the User model, but I get some errors when I am trying to save the User. The error is:</p>
<pre>IntegrityError at /join/

(1048, "Column 'age' cannot be null")

Request Method: 	POST
Request URL: 	<a href="http://localhost:8000/join/" rel="nofollow">http://localhost:8000/join/</a>
Exception Type: 	IntegrityError
Exception Value: 	(1048, "Column 'age' cannot be null")
</pre>
<p>My custom user model looks like this:</p>
<pre>class CustomUser(User):
    age = models.IntegerField()
    occupation = models.IntegerField()

    #Use UserManager to get the create_user method, etc.
    objects = UserManager()
</pre>
<p>The view that tries to save the user looks like this:</p>
<pre>def join(request):
    """Creates a new user."""
    title= "Join"
    if request.method == 'POST':
        username = request.POST.get('username', '')
        password = request.POST.get('password', '')
        email = request.POST.get('email', '')
        user = CustomUser.objects.create_user(username, email, password);
        user.age = request.POST.get('age', '')
        user.occupation = request.POST.get('occupation', '')
        user.save()
        return HttpResponseRedirect('/')
    return render_to_response('new.html', locals())
</pre>
<p>Can you please help me to find out what am I doing wrong?</p>
<p>Thank you!</p>
	<p><cite>Comment by <a href="http://readyroom.wordpress.com/" rel="external nofollow" class="url">Radu</a> — 12 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-616">12:40 am</a></cite> </p>
	</li>

	<li id="comment-621">
	<p>Scott, This is very interesting. Thanks for writing it up. I look forward to trying it. Does this break any code (Django or third-party) that references User beyond Django Auth? Or do your tweaks mean that any app that references User is actually referencing CustomUser? I’d like to use Django Groups and other User-related code without having to worry about it breaking because of this approach.</p>
<p>Generally, is there any reason NOT to do this versus the old CustomProfile approach? Thanks!</p>
	<p><cite>Comment by mc3 — 13 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-621">10:53 pm</a></cite> </p>
	</li>

	<li id="comment-622">
	<p>@mc3</p>
<p>If you use a custom authentication backend as I have, you should find the User is always a CustomUser.  I haven’t tried it with any third-party apps so I can’t say if it breaks anything but I don’t see why it would.  We’re using it at <a href="http://www.redrobotstudios.com/" rel="nofollow">Red Robot</a> and so far it’s working well.</p>
	<p><cite>Comment by Scott — 14 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-622">10:23 am</a></cite> </p>
	</li>

	<li id="comment-623">
	<p>Scott,<br>
Thanks. I’m giving it a shot. I thought I had replciated all your steps correctly but I get this error. </p>
<p>Seems to get hung up on this line:<br>
        except self.user_class.DoesNotExist:</p>
<p>Not sure how to get round it.</p>
<p>Exception Value:<br>
‘NoneType’ object has no attribute ‘DoesNotExist’<br>
Exception Location: 	/home/ldm616/webapps/django/fabproject/auth_backends.py in authenticate, line 12</p>
	<p><cite>Comment by mc3 — 14 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-623">6:42 pm</a></cite> </p>
	</li>

	<li id="comment-624">
	<p>@mc3</p>
<p>Check <code>CUSTOM_USER_MODEL</code> is set in your settings.py file.  It sounds like the authentication backend is failing to get your model class (uses django.db.models.get_model).</p>
	<p><cite>Comment by Scott — 14 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-624">6:54 pm</a></cite> </p>
	</li>

	<li id="comment-629">
	<p>I think I’ve a solution to matt’s and radu’s problem.<br>
Just use the CustomUser-Model like a normal model, save all needed data, like username, first_name, last_name, password etc.</p>
<pre>&gt;&gt;&gt; new_user = CustomUser(username='newuser', first_name='firstname', last_name='lastname', password='pass'....)
&gt;&gt;&gt; new_user.save()</pre>
<p>!!ATTENTION!!<br>
After saving the new user, you’ve to set the encrypted password!</p>
<pre>&gt;&gt;&gt; user = User.objects.get(username__exact='newuser')
&gt;&gt;&gt; user.set_password('pass')
&gt;&gt;&gt; user.save()</pre>
<p>It’s just a workaround, but it works fine here…</p>
	<p><cite>Comment by metty — 16 January 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-629">12:33 pm</a></cite> </p>
	</li>

	<li id="comment-645">
	<p>@mc3<br>
I had that problem, and I changed CUSTOM_USER_MODEL from ‘accounts.CustomUser’ to ‘mysite.CustomUser’</p>
<p>@metty<br>
Is there some way to have set_password called when creating the CustomUser from that Admin interface?</p>
	<p><cite>Comment by <a href="http://enja.org/" rel="external nofollow" class="url">Enj</a> — 19 March 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-645">7:40 pm</a></cite> </p>
	</li>

	<li id="comment-648">
	<p>I have been encountering an error when I try to login to the admin interface.  I am using a fresh database.</p>
<p>FieldError at /admin/<br>
Cannot resolve keyword ‘username’ into field. Choices are: basic, id</p>
<p>I am using the the original code in the post, which I think reading the comments should work in my case because I am essentially just adding one extra field to the users.  Thanks for the help.</p>
	<p><cite>Comment by <a href="http://theknoxstudent.com/" rel="external nofollow" class="url">Peter</a> — 21 March 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-648">7:46 pm</a></cite> </p>
	</li>

	<li id="comment-649">
	<p>Hi Peter.</p>
<p>Check your custom user model is inheriting from <code>User</code> not <code>models.Model</code>.  Can’t think why else the username field would not be present.</p>
	<p><cite>Comment by Scott — 22 March 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-649">2:25 pm</a></cite> </p>
	</li>

	<li id="comment-663">
	<p>I’ve tried this with the following issues/problems:<br>
1 — The autodiscover caused an error; so I deleted it.<br>
2 — When I login, it didn’t let me in until I changed my customuser database table to contain a “pointer” to my auth_user table entry (in this case, a 1).<br>
3 — Now, Site administration says: “You don’t have permission to edit anything.”</p>
<p>Any suggestions?</p>
<p>Thanks,</p>
<p>Ken</p>
	<p><cite>Comment by Ken Lerman — 1 May 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-663">6:03 pm</a></cite> </p>
	</li>

	<li id="comment-681">
	<p>Hey Scott,<br>
    Thank you very much for such a informative article. This really helped.<br>
I have the same question as Enj had. (Comment no. 37)</p>
<p>I got it to working till the point, where I can see my CustomUser Object in admin page.<br>
But, when I try to add user using admin site on CustomUser object. I get a plain django form, where password field is plain textbox.( with change password link beside)</p>
<p>Is there any way, where I can add a user using admin site with CustomUser object? And It asks for username and password initially(like when I add a normal user with User object). And then adds a entry into User and CustomUser table.<br>
( I tried many things but not much success,one them was to use django signals and handle post_save() event, Also tried playing around with UserAdmin object…but no success) </p>
<p>Thanks,<br>
Sujit</p>
	<p><cite>Comment by <a href="http://eclectic.in/" rel="external nofollow" class="url">Sujit</a> — 11 June 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-681">5:37 pm</a></cite> </p>
	</li>

	<li id="comment-682">
	<p>Hi Sujit.</p>
<p>Sorry, I’m not adding users in admin, so I’m not sure what the problem would be.  A couple of things you might look at:</p>
<p>1. Is this a problem with User/CustomUser only, or do you get similar behaviour with other model inheritance?  e.g. create one model then another that inherits from it and see what model instance gets created in admin.</p>
<p>2. Does it make a difference what manager CustomUser has?  i.e. if it doesn’t have User’s manager.</p>
<p>3. Could you work around it using a ModelAdmin for CustomUser?</p>
<p>Good luck.</p>
<p>Scott</p>
	<p><cite>Comment by Scott — 12 June 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-682">9:40 am</a></cite> </p>
	</li>

	<li id="comment-693">
	<p>Hello Scott,<br>
      Thank you very much for your reply. I did try many other options but things didn’t quite work according to my requirement. However, I want to use the model inheritance in admin site. Below is the thing I want to achieve. Kindly provide your advise of the same. </p>
<p>1. In my project, There are two types of users, namely Controller and WebUser.<br>
   class Controller(User):<br>
      #more controller related fields<br>
     pass<br>
   class WebUser(User):<br>
     #more webuser related fields<br>
     pass<br>
2. In admin site I register these two classes<br>
   admin.site.register(Controller)<br>
   admin.site.register(WebUser)</p>
<p>3. I want to add and delete Controllers and WebUsers.<br>
   And don’t really want to manage User Objects. Requirement is to keep the semantics for the users<br>
   clean. As controllers are devices which logs in periodically and do some stuff and Webusers are<br>
   normal human users which interact with the system.</p>
<p>Problems:<br>
1. I do get the Add form for both Controller and WebUser joined with retrospective User object.<br>
   The problem is in password field is displayed as plain text( when saved saves it in plain text as opposed to with save_password() method).<br>
2. Also, “change password” link doesn’t work as well</p>
<p>Questions:<br>
1. What is the best method to achieve something like above?<br>
2. Any pointers on the similar topics. I have gone through most of the threads available but to no  avail. </p>
<p>Thanks,<br>
Sujit</p>
	<p><cite>Comment by <a href="http://www.eclectic.in/" rel="external nofollow" class="url">Sujit</a> — 6 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-693">5:19 pm</a></cite> </p>
	</li>

	<li id="comment-694">
	<p>@Sujit</p>
<p>Sorry, this is way outside of anything I’ve tried, so I don’t have any advice to offer.</p>
	<p><cite>Comment by Scott — 6 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-694">7:35 pm</a></cite> </p>
	</li>

	<li id="comment-696">
	<p>[...] 20:39     Прочитал тут о расширении модели User с помощью наследования. Решил [...]</p>
	<p><cite>Pingback by <a href="http://softwaremaniacs.org/forum/django/13029/" rel="external nofollow" class="url">Расширение модели User</a> — 8 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-696">5:39 pm</a></cite> </p>
	</li>

	<li id="comment-700">
	<p>NameError: name ‘models’ is not defined</p>
<p>When I extend the User object in version 1.0.2 of django using the instructions provided in this post, I get this error.</p>
<p>my code is simple:<br>
<code><br>
from django.contrib.auth.models import User</code></p><code>
</code><p><code>class TestUser(User):<br>
	foo=models.CharField(max_length=40)<br>
</code></p>
<p>I have a feeling that Django Version 1.1’s Proxy Class definition will address this issue, but I wanted to check with your community to see if this is a common problem.</p>
	<p><cite>Comment by bartosz — 22 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-700">9:23 pm</a></cite> </p>
	</li>

	<li id="comment-701">
	<p>@bartosz</p>
<p>Do you also have <code>from django.db import models</code> ?  It looks like you are using <code>models.CharField</code>, without importing <code>models</code>.</p>
	<p><cite>Comment by Scott — 23 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-701">10:33 am</a></cite> </p>
	</li>

	<li id="comment-702">
	<p>This idea is actually great. Thanks, and I think it would be nice to promote this method as much as possible.</p>
<p>Yet I failed to apply this method successfully.<br>
First, the changes I’ve made:</p>
<p>— Added to settings.py bottom:</p>
<pre>AUTHENTICATION_BACKENDS = (
    'website.auth_backends.CustomUserModelBackend',
)

CUSTOM_USER_MODEL = 'profiles.CustomUser'
</pre>
<p>— Added to urls.py top:</p>
<pre>from django.conf.urls.defaults import *
from django.contrib.auth.models import User
from django.contrib import admin
admin.autodiscover()
admin.site.unregister(User)
</pre>
<p>— settings.py INSTALLED_APPS:</p>
<pre>(    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.admin',
    'fullhistory',
    'website.courses',
    'website.profiles' )
</pre>
<p>— profiles/models.py:</p>
<pre>from django.db import models
from django.contrib.auth.models import User, UserManager
from fullhistory import register_model #this has nothing to do with users, it just logs every write to the database
from website.courses.models import Course #website is my Django project folder obviously

class CustomUser(User):
    cellphone = models.CharField(max_length=20)
    courses = models.ForeignKey(Course, null=True, blank=True)
    updatedat = models.DateTimeField(null=True, blank=True)

    objects = UserManager()
</pre>
<p>I’ve tried with and without AUTH_PROFILE_MODULE = ‘profiles.CustomUser’, but with no luck.</p>
<p>Any suggestions?</p>
<p>Forgot to add, it gives me 403 CSRF.</p>
	<p><cite>Comment by <a href="http://hayat-necmettin.blogspot.com/" rel="external nofollow" class="url">Necmettin Begiter</a> — 26 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-702">4:23 pm</a></cite> </p>
	</li>

	<li id="comment-704">
	<p>@Necmettin Begiter</p>
<p>If the 403 CSRF error is the problem you are having I suggest you remove <code>django.contrib.csrf.middleware.CsrfMiddleware</code> from your <code>MIDDLEWARE_CLASSES</code> and find out what the problem really is.</p>
	<p><cite>Comment by Scott — 26 July 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-704">9:28 pm</a></cite> </p>
	</li>

	<li id="comment-707">
	<p>Hi all.<br>
I tried to create a form from CustomUser model. Everything  is fine except that fields from customUser model can’t be saved.<br>
Sorry for my bad English</p>
	<p><cite>Comment by <a href="http://masarliev.net/" rel="external nofollow" class="url">Masarliev</a> — 11 August 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-707">6:07 pm</a></cite> </p>
	</li>

	<li id="comment-712">
	<p>I just wanted to say thank you. This is an elegant solution to a common problem.</p>
	<p><cite>Comment by <a href="http://www.varyant.net/" rel="external nofollow" class="url">Jason</a> — 9 September 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-712">7:44 am</a></cite> </p>
	</li>

	<li id="comment-713">
	<p>Hacked this a bit to allow the backend to assign a user subclass based on the user’s group attribute.</p>
<p><a href="http://steps.ucdavis.edu/People/jbremson/extending-the-user-model-in-django" rel="nofollow">http://steps.ucdavis.edu/People/jbremson/extending-the-user-model-in-django</a></p>
	<p><cite>Comment by Joel — 9 September 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-713">9:30 pm</a></cite> </p>
	</li>

	<li id="comment-726">
	<p>$ python manage.py createsuperuser does not ‘obey’ this configuration it stills create the user in User model. Is that a support lack or is there something I’m doing wrong?</p>
	<p><cite>Comment by <a href="http://www.mgonzalez.cl/" rel="external nofollow" class="url">MarioGonzalez</a> — 1 October 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-726">11:43 pm</a></cite> </p>
	</li>

	<li id="comment-742">
	<p>I found a hack to fix the createsuperuser and other problems when one creates a user instead of the custom user.  Just use a sql trigger(I use mysql).  Something like</p>
<p>delimiter //<br>
create trigger trigger_custom_user<br>
after insert on auth_user<br>
for each row<br>
begin<br>
insert into myapp_customuser (user_ptr_id) values(NEW.id);<br>
//</p>
<p>It’s at the sql level and therefore not ideal, but it works.</p>
	<p><cite>Comment by <a href="http://davidmburke.wordpress.com/" rel="external nofollow" class="url">Bufke</a> — 28 November 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-742">1:37 am</a></cite> </p>
	</li>

	<li id="comment-747">
	<p>[...] other things we wanted, so it made sense for us to use it. The next question is whether we try the inheritance approach or do we treat our legacy users table as a sort of User Profile and utilize the User module using [...]</p>
	<p><cite>Pingback by <a href="http://spindrop.us/2009/12/15/django-model-inheritance-or-related-tables-wrt-amo/" rel="external nofollow" class="url">Django: Model Inheritance or Related Tables wrt AMO at Spindrop</a> — 15 December 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-747">9:12 pm</a></cite> </p>
	</li>

	<li id="comment-752">
	<p>I have found one problem with apply this new extension to the User class. Maybe there is a simple solution to it..</p>
<p>When I create a foreign key to the new CustomUser class and specify “to_field = ‘username’” it works fine with validation and saving but the moment you try and do a order_by on the new model which references a field in the User model it fails with customuser__username  field not found. </p>
<p>Example:</p>
<pre>class CustomUser(User):
    ......

class X(models.Model):
    added_by = models.ForeignKey(CustomUser, to_field = 'username')

X.objects.all().order_by('added_by__last_name)
</pre>
<p>I use auto complete fields in my forms that use the username as a value so if I don’t specify to_field in my model the validation will fail as it’s expecting the CustomUser.id.</p>
<p>Maybe there is a way to tell the ModelForm to validate using the username?</p>
	<p><cite>Comment by Karol Joc — 21 December 2009 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-752">12:42 pm</a></cite> </p>
	</li>

	<li id="comment-766">
	<p>Hi,</p>
<p>thank you for this article.</p>
<p>Unfortunately i’m having an issue; i’m able to create a CustomUser through the admin interface (like described in comment #8).<br>
But the CustomUsers will appears in admin/auth/user/ (without the custom fields) and nothing will appear in admin/myapp/customuser/.</p>
<p>Is there a clean way to fully add/list/edit extended users through the admin interface or must i make my own admin interface?</p>
	<p><cite>Comment by bufh — 20 January 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-766">5:12 pm</a></cite> </p>
	</li>

	<li id="comment-780">
	<p>[...] 0    0        Хочу узнать как лучше регистрировать пользователей на сайте, которым будет закрыт доступ к админке, но с использованием джанговской идентификации.Есть такое приложение — django-registration <a href="http://code.google.com/p/django-registration/" rel="nofollow">http://code.google.com/p/django-registration/</a>. Оно предоставляет все необходимое для регистрации пользователей с активацией аккаунта через почту.Все зарегистрированные пользователи будут вперемешку с администраторами в списке ПользователиВ админке есть фильтры =) Поставьте фильтрацию по «Статусу персонала».Модель User имеет ограниченный набор полейДа, можно воспользоваться расширением через UserProfile, а некоторые наследуют от стандартного User свой класс — <a href="./Extending the Django User model with inheritance_files/Extending the Django User model with inheritance.htm" rel="nofollow">http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/</a>. [...]</p>
	<p><cite>Pingback by <a href="http://softwaremaniacs.org/forum/django/21149/" rel="external nofollow" class="url">Регистрация и идентификация пользователей</a> — 8 April 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-780">7:46 am</a></cite> </p>
	</li>

	<li id="comment-789">
	<p>[...] Original Source [...]</p>
	<p><cite>Pingback by <a href="http://webit.ca/2010/05/extending-django-user/" rel="external nofollow" class="url">Extending the Django User model &lt; WebIT.ca</a> — 6 May 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-789">3:33 am</a></cite> </p>
	</li>

	<li id="comment-794">
	<p>Hi Scott,</p>
<p>thanx for the solution – it is exactly what i was seraching for – but somehow it is not working.</p>
<p>When trying to log in the admin site for example, i get the</p>
<pre>"ImproperlyConfigured at /admin/

Module "mysite.auth_backends" does not define a "CustomUserModelBackend" authentication backend
</pre>
<p>The auth_backends.py is exactly the same you showed, and the CustomUser is just different in it’s fields (not timezone for example)</p>
<p>My Settings is configured like this:</p>
<pre>AUTH_PROFILE_MODULE = 'mysite..user_ext'

AUTHENTICATION_BACKENDS = (
    'mysite.auth_backends.CustomUserModelBackend',
)
</pre>
<p>Any ideas? I want to feel the magic pony ;)</p>
<p>Regards,<br>
Kalle</p>
	<p><cite>Comment by Kalle — 16 May 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-794">8:01 pm</a></cite> </p>
	</li>

	<li id="comment-875">
	<p>[...] already seen a few ways to do it, but can't decide on which one is the [...]</p>
	<p><cite>Pingback by <a href="http://htmlcoderhelper.com/extending-the-user-model-with-custom-fields-in-django/" rel="external nofollow" class="url">Extending the User model with custom fields in Django — HTMLCoderHelper.com</a> — 14 November 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-875">11:46 am</a></cite> </p>
	</li>

	<li id="comment-906">
	<p>Huge thanks! Very useful! I struggled a bit because at first I was calling an Abstract class as for  my UserProfile.. but once I figured it out and replaced it by a proper class, your code worked beautifully!</p>
	<p><cite>Comment by Cocobuster — 29 November 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-906">7:26 am</a></cite> </p>
	</li>

	<li id="comment-950">
	<p>Hallo,</p>
<p>can someone tell me the easiest way to get the Groups tol return my custom user in their user_set?</p>
<p>I want do do something like that:</p>
<p>u_set =  Group.objects.get(name=’Groupname’).customuser_set.all()</p>
<p>instead of</p>
<p>u_set =  Group.objects.get(name=’Groupname’).user_set.all()</p>
<p>Can someone help me?</p>
	<p><cite>Comment by Josch — 18 December 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-950">9:22 pm</a></cite> </p>
	</li>

	<li id="comment-951">
	<p>@Josch</p>
<p>Off the top of my head, you could get custom users for a group with something like:</p>
<p>group = Group.objects.get(name=’Groupname’)<br>
u_set = CustomUser.objects.filter(groups__contains=group)</p>
	<p><cite>Comment by Scott — 18 December 2010 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-951">10:38 pm</a></cite> </p>
	</li>

	<li id="comment-997">
	<p>[...] 我已经看到了一些 办法来做到这一点，但不能决定哪一个是最好的。     This entry was posted in 技术难题 and tagged [...]</p>
	<p><cite>Pingback by <a href="http://comeonwith.me/questions/%e7%94%a8%e8%87%aa%e5%ae%9a%e4%b9%89%e7%9a%84%e5%ad%97%e6%ae%b5%e5%9c%a8django%e7%9a%84%e7%94%a8%e6%88%b7%e6%a8%a1%e5%9e%8b.html" rel="external nofollow" class="url">用自定义的字段在Django的用户模型 | IT技术问答论坛IT技术问答论坛</a> — 10 February 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-997">7:07 pm</a></cite> </p>
	</li>

	<li id="comment-1005">
	<p>[...] would like each shop to be able to login to my application. Following as best I can the guide at <a href="./Extending the Django User model with inheritance_files/Extending the Django User model with inheritance.htm" rel="nofollow">http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/</a> and various other googlings, I’ve got part of the way there, but I’ve run into a [...]</p>
	<p><cite>Pingback by <a href="http://codinganswers.info/index.php/2011/02/creating-custom-user-backends-in-django/" rel="external nofollow" class="url">Creating Custom User Backends in Django&nbsp;|&nbsp;Coding Answers</a> — 25 February 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1005">5:04 pm</a></cite> </p>
	</li>

	<li id="comment-1014">
	<p>This looks like a great way to extend the User model class. As your original article was way back in 2008, I’m just wondering if any key issues have come to light over that time -esp with new releases of django – which have altered how you feel about this solution? For my part, I think this is a very elegant solution.</p>
	<p><cite>Comment by Michael — 4 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1014">12:17 am</a></cite> </p>
	</li>

	<li id="comment-1015">
	<p>@Michael</p>
<p>I don’t recall any changes in django releases that caused problems.  It works and I have used it in some projects, though I still use the ‘old way’ of user profiles as well.  Inheriting from the User model can be slightly more awkward in admin.  It depends what you’re doing – there’s definitely scope for both approaches.</p>
	<p><cite>Comment by Scott — 4 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1015">10:46 am</a></cite> </p>
	</li>

	<li id="comment-1016">
	<p>Hello Scott – thanks for quick the reply. By the way, I had a look at your company site Red Robot – very impressive stuff you’re doing. I’m going to experiment with your technique and see how it pans out. Really appreciate that people like you are supportive and open with their knowledge.</p>
	<p><cite>Comment by Michael — 4 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1016">11:42 am</a></cite> </p>
	</li>

	<li id="comment-1022">
	<p>Very good your article, congratulations to you and your work.</p>
<p>But I have a doubt.</p>
<p>Below is the code for you to see and error message.</p>
<p>Thank you very much if you can help me.</p>
<p>Thanks!</p>
<p>models.py</p>
<pre>class MeuUser(User):
    """ stores customer order information used with the last order placed; can be attached to the checkout order form
    as a convenience to registered customers who have placed an order in the past.

    """
    cpf = personalized_field.CPFField()
    telefone = personalized_field.TelefoneField() 

    objects=UserManager()
</pre>
<p>forms.py</p>
<pre>class FormularioRegistro(forms.Form):
    nome = forms.CharField(label=u'Nome')
    sobrenome = forms.CharField(label=u'Sobrenome')
    email = forms.EmailField(label=u'Email')
    senha1 = forms.CharField(label=u'Senha',widget=forms.PasswordInput())
    senha2 = forms.CharField(label=u'Senha (Novamente)',widget=forms.PasswordInput())
    cpf = campo_personalizado.CPFField(label=u"Digite o seu CPF")
    telefone = campo_personalizado.TelefoneField(label=u"Digite o Telfone")
</pre>
<p>views.py</p>
<pre>if request.method == 'POST':
        postdata = request.POST.copy()
        form = FormularioRegistro(postdata)
        if form.is_valid():
	    username = request.POST.get('email', '')
            password = request.POST.get('senha1', '')
            email = request.POST.get('email', '')
            user = MeuUser.objects.create_user(username, email, password);
            user.cpf = request.POST.get('cpf', '')
            user.telefone = request.POST.get('telefone', '')
            user.save()
            return HttpResponseRedirect('/')
            novo_usuario = authenticate(username=user.email, password=cd.get('senha'))
</pre>
<p>Error	</p>
<p>Cannot resolve keyword ‘cpf’ into field. Choices are: _message_set, cupon_adquirido, date_joined, email, first_name, groups, id, is_active, is_staff, is_superuser, last_login, last_name, logentry, meuuser, password, user_permissions, username</p>
	<p><cite>Comment by jhoni — 29 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1022">8:49 pm</a></cite> </p>
	</li>

	<li id="comment-1023">
	<p>@jhoni</p>
<p>Strange, it works ok for me.  Try <code>print type(user)</code> after you call <code>create_user</code> and check if it is an <code>MeuUser</code> instance.</p>
	<p><cite>Comment by Scott — 29 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1023">10:27 pm</a></cite> </p>
	</li>

	<li id="comment-1024">
	<p>[...]   0    0        <a href="./Extending the Django User model with inheritance_files/Extending the Django User model with inheritance.htm" rel="nofollow">http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/</a> нашёл такой пост. На сколько оно актуально в [...]</p>
	<p><cite>Pingback by <a href="http://softwaremaniacs.org/forum/django/31551/" rel="external nofollow" class="url">AUTH_PROFILE_MODULE</a> — 30 April 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1024">7:27 pm</a></cite> </p>
	</li>

	<li id="comment-1027">
	<p>Scott, you are right, i’am wrong in other details about my code.</p>
<p>Once on more thank you very much, </p>
<p>[]’s</p>
	<p><cite>Comment by jhoni — 2 May 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1027">1:50 pm</a></cite> </p>
	</li>

	<li id="comment-1047">
	<p>Hi all!<br>
As the user comment 36, i got the problem with the passwords. They are not encryptated, so i had to override the save method.<br>
Btw, i´m adding users only in admin interface, so, i´ve created a defaultAdmin to this. </p>
<p>In admin.py: </p>
<pre>class defaultAdminModel(admin.ModelAdmin):
	def save_model(self, request, obj, form, change):
		obj.set_password(obj.password)
		obj.save()

Now, the others admin classes:
class AdminLocaisAtendimento(defaultAdminModel):
</pre>
<p>Thanks ! ;)</p>
	<p><cite>Comment by <a href="http://chevitarese.wordpress.com/" rel="external nofollow" class="url">Fred Chevitarese</a> — 28 June 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1047">2:20 pm</a></cite> </p>
	</li>

	<li id="comment-1048">
	<p>[...] Outro artigo muito bom (inglês) é este aqui. <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance" rel="nofollow">http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance</a> [...]</p>
	<p><cite>Pingback by <a href="http://chevitarese.wordpress.com/2011/06/28/extendendo-user-do-django/" rel="external nofollow" class="url">Extendendo User do Django « Fred Chevitarese …</a> — 28 June 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1048">2:31 pm</a></cite> </p>
	</li>

	<li id="comment-1049">
	<p>[...] already seen a few ways to do it, but can’t decide on which one is the [...]</p>
	<p><cite>Pingback by <a href="http://programmersgoodies.com/extending-the-user-model-with-custom-fields-in-django" rel="external nofollow" class="url">Extending the User model with custom fields in Django - Programmers Goodies</a> — 4 July 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1049">6:46 pm</a></cite> </p>
	</li>

	<li id="comment-1051">
	<p>I have used the inheritence method to build a CustomUser class. Apparently its working absolutely fine but when I create a new user from admin, its password is not being encoded and as a result, I am unable to login with the newly created user. However, login action do not produce any error on the screen but the user is not being redirected to its home page. When I try to update the user from admin site. the password is being displayed in plain text and not in the encded format.</p>
<p>thanks in advance for any help. I am really stuck!!!</p>
	<p><cite>Comment by Ammara — 18 July 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1051">3:20 am</a></cite> </p>
	</li>

	<li id="comment-1052">
	<p>Ammara – see this post for a variation that deals with the Pasword not being encrypted and also the admin user not using this class but instead the original User.<br>
<a href="http://www.kolios.dk/2010/01/22/how-to-extend-django-user-class-and-change-authentication-middleware/" rel="nofollow">http://www.kolios.dk/2010/01/22/how-to-extend-django-user-class-and-change-authentication-middleware/</a><br>
Also see here for a more elegant solution for User override using User classname instead of CustomUser and Admin fix.<br>
<a href="http://nigel.jp/2011/06/django-user-authentication-and-extending-the-user-model/" rel="nofollow">http://nigel.jp/2011/06/django-user-authentication-and-extending-the-user-model/</a></p>
<p>However you need to mix all three approaches to solve the problems in any one of them.<br>
Would be great if this post was updated (or a new post replacing it) to reflect the best way to do all of this… (IMHO)<br>
Thanks Scott for getting this started… Please consider doing an update and straighteneing all the wiggles out…</p>
	<p><cite>Comment by mark — 29 July 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1052">11:30 am</a></cite> </p>
	</li>

	<li id="comment-1054">
	<p>[...] codice l’ho rubacchiato da un blog. from django.contrib.auth.models import User, UserManager  class CustomUser(User): &nbsp; [...]</p>
	<p><cite>Pingback by <a href="http://markon.netsons.org/2011/08/09/come-estendere-la-classe-user-in-django/" rel="external nofollow" class="url">Come estendere la classe User in Django</a> — 9 August 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1054">4:22 pm</a></cite> </p>
	</li>

	<li id="comment-1061">
	<p>[...] referencia y tienen algunos de estos ejemplos: Documentación en DJango para múltiples sitios  Extending the django user model with inheritance Doing more with the Django admin Add a button to Django admin to login as a user   [...]</p>
	<p><cite>Pingback by <a href="http://blog.developer.cl/?p=152" rel="external nofollow" class="url">Django con Admin MultiSite « developer.cl</a> — 26 September 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1061">5:04 am</a></cite> </p>
	</li>

	<li id="comment-1071">
	<p>Hi Scott, liked the inheritance but can anyone suggest how I can make an attribute of the child model required, if it is inheriting the User class without saving the user if the instance of the child model is not saved? eg.</p>
<pre>class Customer(User):
organization = models.CharField(max_length=80, unique = True)
address = models.CharField(max_length=80)
.
..
objects = UserManager()</pre>
<p>If in the admin.py, model Customer is registered, on execution, we get the user creation form, with password after saving it, we exit from the module. We are able to see that the user exists in the django Auth, even if the Customer is not yet created. How do I override the save of the User class. Also I need to create other users for the application the normal way. Please suggest</p>
	<p><cite>Comment by mghs — 30 December 2011 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1071">10:30 am</a></cite> </p>
	</li>

	<li id="comment-1084">
	<p>i get this error when i try to access my version of ‘CustomUser’ model on the admin site(i have shortened it for clarity):<br>
no such column: app_name_publicprofile.user_ptr_id.<br>
Here is my model:</p>
<pre>class PublicProfile(User):
    sex = models.CharField(max_length=100,choices=settings.SEX_CHOICES,
verbose_name='sex')
    phone_num = models.IntegerField(verbose_name='phone number')
    id_num = models.IntegerField(verbose_name='id number')
    age = models.DateField(verbose_name='date of birth')
    occupation = models.CharField(max_length= 20,
verbose_name='occupation')
    picture = models.ImageField(upload_to ='user_profile_images',
verbose_name='user photo')

    objects = UserManager()
</pre>
<p>but i can add users in the admin site.</p>
<p>Any ideas?</p>
	<p><cite>Comment by Mwai — 16 January 2012 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1084">8:22 pm</a></cite> </p>
	</li>

	<li id="comment-1106">
	<p>So, old post, but I found it so this might be helpful for someone. Similar to #74, but if you are saving your Profile outside of the admin you can override your CustomUser’s save class. It could look something like this:</p>
<pre>def save(self, *args, **kwargs):
    self.set_password(self.password)
    super(CustomUser, self).save(*args, **kwargs)
</pre>
<p><a href="https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-model-methods" rel="nofollow">https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-model-methods</a></p>
	<p><cite>Comment by Andy — 28 March 2012 @ <a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/#comment-1106">6:19 am</a></cite> </p>
	</li>


</ol>


<p><a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/feed/"><abbr title="Really Simple Syndication">RSS</abbr> feed for comments on this post.</a>	<a href="http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/trackback/" rel="trackback">TrackBack <abbr title="Universal Resource Locator">URL</abbr></a>
</p>

<h2 id="postcomment">Leave a comment</h2>


<form action="http://scottbarnham.com/blog/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author"><small>Name (required)</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email"><small>Mail (will not be published) (required)</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url"><small>Website</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment">
<input type="hidden" name="comment_post_ID" value="34">
</p>

</form>





<!-- begin footer -->
</div>


<!-- begin sidebar -->
<div id="menu">

<ul>
	<li class="categories">Categories:<ul>	<li class="cat-item cat-item-25"><a href="http://scottbarnham.com/blog/category/android/" title="View all posts filed under Android">Android</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://scottbarnham.com/blog/category/business/" title="View all posts filed under Business">Business</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://scottbarnham.com/blog/category/data/" title="View all posts filed under Data">Data</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://scottbarnham.com/blog/category/django/" title="Django web development framework">Django</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://scottbarnham.com/blog/category/hosting/" title="View all posts filed under Hosting">Hosting</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://scottbarnham.com/blog/category/javascript/" title="View all posts filed under JavaScript">JavaScript</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://scottbarnham.com/blog/category/linux/" title="View all posts filed under Linux">Linux</a>
</li>
	<li class="cat-item cat-item-18"><a href="http://scottbarnham.com/blog/category/postgresql/" title="View all posts filed under Postgresql">Postgresql</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://scottbarnham.com/blog/category/python/" title="Python programming language">Python</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://scottbarnham.com/blog/category/security/" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://scottbarnham.com/blog/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://scottbarnham.com/blog/category/vmware/" title="View all posts filed under VMWare">VMWare</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://scottbarnham.com/blog/category/washing-machine/" title="View all posts filed under Washing Machine">Washing Machine</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://scottbarnham.com/blog/category/web-development/" title="View all posts filed under Web Development">Web Development</a>
</li>
</ul></li><!-- <li id="search">
   <label for="s">Search:</label>
   <form id="searchform" method="get" action="http://scottbarnham.com/blog">
	<div>
		<input type="text" name="s" id="s" size="15" /><br />
		<input type="submit" value="Search" />
	</div>
	</form>
 </li>-->
 <li id="archives">Archives:	<ul>
	 	<li><a href="http://scottbarnham.com/blog/2011/04/" title="April 2011">April 2011</a></li>
	<li><a href="http://scottbarnham.com/blog/2011/01/" title="January 2011">January 2011</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/12/" title="December 2010">December 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/10/" title="October 2010">October 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/09/" title="September 2010">September 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/08/" title="August 2010">August 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/07/" title="July 2010">July 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/03/" title="March 2010">March 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2010/01/" title="January 2010">January 2010</a></li>
	<li><a href="http://scottbarnham.com/blog/2009/06/" title="June 2009">June 2009</a></li>
	<li><a href="http://scottbarnham.com/blog/2009/03/" title="March 2009">March 2009</a></li>
	<li><a href="http://scottbarnham.com/blog/2008/12/" title="December 2008">December 2008</a></li>
	<li><a href="http://scottbarnham.com/blog/2008/08/" title="August 2008">August 2008</a></li>
	<li><a href="http://scottbarnham.com/blog/2008/04/" title="April 2008">April 2008</a></li>
	<li><a href="http://scottbarnham.com/blog/2008/02/" title="February 2008">February 2008</a></li>
	<li><a href="http://scottbarnham.com/blog/2008/01/" title="January 2008">January 2008</a></li>
	<li><a href="http://scottbarnham.com/blog/2007/11/" title="November 2007">November 2007</a></li>
	<li><a href="http://scottbarnham.com/blog/2007/09/" title="September 2007">September 2007</a></li>
	<li><a href="http://scottbarnham.com/blog/2007/08/" title="August 2007">August 2007</a></li>
	<li><a href="http://scottbarnham.com/blog/2007/07/" title="July 2007">July 2007</a></li>
	<li><a href="http://scottbarnham.com/blog/2007/04/" title="April 2007">April 2007</a></li>
	</ul>
 </li>
	<li class="pagenav">Pages:<ul><li class="page_item page-item-2"><a href="http://scottbarnham.com/blog/about/" title="About">About</a></li>
</ul></li>	<li id="linkcat-6" class="linkcat">Links
	<ul class="xoxo blogroll">
<li><a href="http://www.easyjobboards.com/">Get your own Job Board</a></li>
<li><a href="http://www.redrobotstudios.com/">Red Robot Studios</a></li>
<li><a href="http://twitter.com/scottbarnham">Twitter</a></li>

	</ul>
</li>
<!-- <li id="meta">Meta:	<ul>
				<li><a href="http://scottbarnham.com/blog/wp-login.php">Log in</a></li>
		<li><a href="http://scottbarnham.com/blog/feed/" title="Syndicate this site using RSS"><abbr title="Really Simple Syndication">RSS</abbr></a></li>
		<li><a href="http://scottbarnham.com/blog/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			</ul>
 </li>-->

</ul>

</div>
<!-- end sidebar -->
</div>
<div id="footer">
<p class="credit"><!--19 queries. 0.375 seconds. --> <cite>Powered by <a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform."><strong>WordPress</strong></a></cite> with a hastily-adapted home-made theme</p>
</div>



<!-- Dynamic Page Served (once) in 0.374 seconds -->
<!-- Cached page served by WP-Cache -->
<div id="mixpanel" style="visibility: hidden; "></div></body><link rel="stylesheet" type="text/css" href="data:text/css,"></html>